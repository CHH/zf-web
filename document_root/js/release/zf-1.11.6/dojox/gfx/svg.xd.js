/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.svg"],["require","dojox.gfx._base"],["require","dojox.gfx.shape"],["require","dojox.gfx.path"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.svg"]){_4._hasResource["dojox.gfx.svg"]=true;_4.provide("dojox.gfx.svg");_4.require("dojox.gfx._base");_4.require("dojox.gfx.shape");_4.require("dojox.gfx.path");(function(){var d=_4,g=_6.gfx,gs=g.shape,_7=g.svg;var _8=function(ns,_9){if(document.createElementNS){return document.createElementNS(ns,_9);}else{return document.createElement(_9);}};_7.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};_7.getRef=function(_a){if(!_a||_a=="none"){return null;}if(_a.match(/^url\(#.+\)$/)){return d.byId(_a.slice(5,-1));}if(_a.match(/^#dojoUnique\d+$/)){return d.byId(_a.slice(1));}return null;};_7.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};d.extend(g.Shape,{setFill:function(_b){if(!_b){this.fillStyle=null;this.rawNode.setAttribute("fill","none");this.rawNode.setAttribute("fill-opacity",0);return this;}var f;var _c=function(x){this.setAttribute(x,f[x].toFixed(8));};if(typeof (_b)=="object"&&"type" in _b){switch(_b.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,_b);var _d=this._setFillObject(f,"linearGradient");d.forEach(["x1","y1","x2","y2"],_c,_d);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,_b);var _d=this._setFillObject(f,"radialGradient");d.forEach(["cx","cy","r"],_c,_d);break;case "pattern":f=g.makeParameters(g.defaultPattern,_b);var _e=this._setFillObject(f,"pattern");d.forEach(["x","y","width","height"],_c,_e);break;}this.fillStyle=f;return this;}var f=g.normalizeColor(_b);this.fillStyle=f;this.rawNode.setAttribute("fill",f.toCss());this.rawNode.setAttribute("fill-opacity",f.a);this.rawNode.setAttribute("fill-rule","evenodd");return this;},setStroke:function(_f){var rn=this.rawNode;if(!_f){this.strokeStyle=null;rn.setAttribute("stroke","none");rn.setAttribute("stroke-opacity",0);return this;}if(typeof _f=="string"||d.isArray(_f)||_f instanceof d.Color){_f={color:_f};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_f);s.color=g.normalizeColor(s.color);if(s){rn.setAttribute("stroke",s.color.toCss());rn.setAttribute("stroke-opacity",s.color.a);rn.setAttribute("stroke-width",s.width);rn.setAttribute("stroke-linecap",s.cap);if(typeof s.join=="number"){rn.setAttribute("stroke-linejoin","miter");rn.setAttribute("stroke-miterlimit",s.join);}else{rn.setAttribute("stroke-linejoin",s.join);}var da=s.style.toLowerCase();if(da in _7.dasharray){da=_7.dasharray[da];}if(da instanceof Array){da=d._toArray(da);for(var i=0;i<da.length;++i){da[i]*=s.width;}if(s.cap!="butt"){for(var i=0;i<da.length;i+=2){da[i]-=s.width;if(da[i]<1){da[i]=1;}}for(var i=1;i<da.length;i+=2){da[i]+=s.width;}}da=da.join(",");}rn.setAttribute("stroke-dasharray",da);rn.setAttribute("dojoGfxStrokeStyle",s.style);}return this;},_getParentSurface:function(){var _10=this.parent;for(;_10&&!(_10 instanceof g.Surface);_10=_10.parent){}return _10;},_setFillObject:function(f,_11){var _12=_7.xmlns.svg;this.fillStyle=f;var _13=this._getParentSurface(),_14=_13.defNode,_15=this.rawNode.getAttribute("fill"),ref=_7.getRef(_15);if(ref){_15=ref;if(_15.tagName.toLowerCase()!=_11.toLowerCase()){var id=_15.id;_15.parentNode.removeChild(_15);_15=_8(_12,_11);_15.setAttribute("id",id);_14.appendChild(_15);}else{while(_15.childNodes.length){_15.removeChild(_15.lastChild);}}}else{_15=_8(_12,_11);_15.setAttribute("id",g._base._getUniqueId());_14.appendChild(_15);}if(_11=="pattern"){_15.setAttribute("patternUnits","userSpaceOnUse");var img=_8(_12,"image");img.setAttribute("x",0);img.setAttribute("y",0);img.setAttribute("width",f.width.toFixed(8));img.setAttribute("height",f.height.toFixed(8));img.setAttributeNS(_7.xmlns.xlink,"href",f.src);_15.appendChild(img);}else{_15.setAttribute("gradientUnits","userSpaceOnUse");for(var i=0;i<f.colors.length;++i){var c=f.colors[i],t=_8(_12,"stop"),cc=c.color=g.normalizeColor(c.color);t.setAttribute("offset",c.offset.toFixed(8));t.setAttribute("stop-color",cc.toCss());t.setAttribute("stop-opacity",cc.a);_15.appendChild(t);}}this.rawNode.setAttribute("fill","url(#"+_15.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return _15;},_applyTransform:function(){var _16=this.matrix;if(_16){var tm=this.matrix;this.rawNode.setAttribute("transform","matrix("+tm.xx.toFixed(8)+","+tm.yx.toFixed(8)+","+tm.xy.toFixed(8)+","+tm.yy.toFixed(8)+","+tm.dx.toFixed(8)+","+tm.dy.toFixed(8)+")");}else{this.rawNode.removeAttribute("transform");}return this;},setRawNode:function(_17){var r=this.rawNode=_17;if(this.shape.type!="image"){r.setAttribute("fill","none");}r.setAttribute("fill-opacity",0);r.setAttribute("stroke","none");r.setAttribute("stroke-opacity",0);r.setAttribute("stroke-width",1);r.setAttribute("stroke-linecap","butt");r.setAttribute("stroke-linejoin","miter");r.setAttribute("stroke-miterlimit",4);},setShape:function(_18){this.shape=g.makeParameters(this.shape,_18);for(var i in this.shape){if(i!="type"){this.rawNode.setAttribute(i,this.shape[i]);}}this.bbox=null;return this;},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this;},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this;}});_4.declare("dojox.gfx.Group",g.Shape,{constructor:function(){_7.Container._init.call(this);},setRawNode:function(_19){this.rawNode=_19;}});g.Group.nodeType="g";_4.declare("dojox.gfx.Rect",gs.Rect,{setShape:function(_1a){this.shape=g.makeParameters(this.shape,_1a);this.bbox=null;for(var i in this.shape){if(i!="type"&&i!="r"){this.rawNode.setAttribute(i,this.shape[i]);}}if(this.shape.r){this.rawNode.setAttribute("ry",this.shape.r);this.rawNode.setAttribute("rx",this.shape.r);}return this;}});g.Rect.nodeType="rect";g.Ellipse=gs.Ellipse;g.Ellipse.nodeType="ellipse";g.Circle=gs.Circle;g.Circle.nodeType="circle";g.Line=gs.Line;g.Line.nodeType="line";_4.declare("dojox.gfx.Polyline",gs.Polyline,{setShape:function(_1b,_1c){if(_1b&&_1b instanceof Array){this.shape=g.makeParameters(this.shape,{points:_1b});if(_1c&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=g.makeParameters(this.shape,_1b);}this.bbox=null;this._normalizePoints();var _1d=[],p=this.shape.points;for(var i=0;i<p.length;++i){_1d.push(p[i].x.toFixed(8),p[i].y.toFixed(8));}this.rawNode.setAttribute("points",_1d.join(" "));return this;}});g.Polyline.nodeType="polyline";_4.declare("dojox.gfx.Image",gs.Image,{setShape:function(_1e){this.shape=g.makeParameters(this.shape,_1e);this.bbox=null;var _1f=this.rawNode;for(var i in this.shape){if(i!="type"&&i!="src"){_1f.setAttribute(i,this.shape[i]);}}_1f.setAttribute("preserveAspectRatio","none");_1f.setAttributeNS(_7.xmlns.xlink,"href",this.shape.src);return this;}});g.Image.nodeType="image";_4.declare("dojox.gfx.Text",gs.Text,{setShape:function(_20){this.shape=g.makeParameters(this.shape,_20);this.bbox=null;var r=this.rawNode,s=this.shape;r.setAttribute("x",s.x);r.setAttribute("y",s.y);r.setAttribute("text-anchor",s.align);r.setAttribute("text-decoration",s.decoration);r.setAttribute("rotate",s.rotated?90:0);r.setAttribute("kerning",s.kerning?"auto":0);r.setAttribute("text-rendering","optimizeLegibility");if(!_4.isIE){r.textContent=s.text;}else{r.appendChild(document.createTextNode(s.text));}return this;},getTextWidth:function(){var _21=this.rawNode,_22=_21.parentNode,_23=_21.cloneNode(true);_23.style.visibility="hidden";var _24=0,_25=_23.firstChild.nodeValue;_22.appendChild(_23);if(_25!=""){while(!_24){_24=parseInt(_23.getBBox().width);}}_22.removeChild(_23);return _24;}});g.Text.nodeType="text";_4.declare("dojox.gfx.Path",g.path.Path,{_updateWithSegment:function(_26){g.Path.superclass._updateWithSegment.apply(this,arguments);if(typeof (this.shape.path)=="string"){this.rawNode.setAttribute("d",this.shape.path);}},setShape:function(_27){g.Path.superclass.setShape.apply(this,arguments);this.rawNode.setAttribute("d",this.shape.path);return this;}});g.Path.nodeType="path";_4.declare("dojox.gfx.TextPath",g.path.TextPath,{_updateWithSegment:function(_28){g.Path.superclass._updateWithSegment.apply(this,arguments);this._setTextPath();},setShape:function(_29){g.Path.superclass.setShape.apply(this,arguments);this._setTextPath();return this;},_setTextPath:function(){if(typeof this.shape.path!="string"){return;}var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=document.createTextNode("");tp.appendChild(tx);r.appendChild(tp);}var ref=r.firstChild.getAttributeNS(_7.xmlns.xlink,"href"),_2a=ref&&_7.getRef(ref);if(!_2a){var _2b=this._getParentSurface();if(_2b){var _2c=_2b.defNode;_2a=_8(_7.xmlns.svg,"path");var id=g._base._getUniqueId();_2a.setAttribute("id",id);_2c.appendChild(_2a);r.firstChild.setAttributeNS(_7.xmlns.xlink,"href","#"+id);}}if(_2a){_2a.setAttribute("d",this.shape.path);}},_setText:function(){var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=document.createTextNode("");tp.appendChild(tx);r.appendChild(tp);}r=r.firstChild;var t=this.text;r.setAttribute("alignment-baseline","middle");switch(t.align){case "middle":r.setAttribute("text-anchor","middle");r.setAttribute("startOffset","50%");break;case "end":r.setAttribute("text-anchor","end");r.setAttribute("startOffset","100%");break;default:r.setAttribute("text-anchor","start");r.setAttribute("startOffset","0%");break;}r.setAttribute("baseline-shift","0.5ex");r.setAttribute("text-decoration",t.decoration);r.setAttribute("rotate",t.rotated?90:0);r.setAttribute("kerning",t.kerning?"auto":0);r.firstChild.data=t.text;}});g.TextPath.nodeType="text";_4.declare("dojox.gfx.Surface",gs.Surface,{constructor:function(){_7.Container._init.call(this);},destroy:function(){this.defNode=null;this.inherited(arguments);},setDimensions:function(_2d,_2e){if(!this.rawNode){return this;}this.rawNode.setAttribute("width",_2d);this.rawNode.setAttribute("height",_2e);return this;},getDimensions:function(){var t=this.rawNode?{width:g.normalizedLength(this.rawNode.getAttribute("width")),height:g.normalizedLength(this.rawNode.getAttribute("height"))}:null;return t;}});g.createSurface=function(_2f,_30,_31){var s=new g.Surface();s.rawNode=_8(_7.xmlns.svg,"svg");if(_30){s.rawNode.setAttribute("width",_30);}if(_31){s.rawNode.setAttribute("height",_31);}var _32=_8(_7.xmlns.svg,"defs");s.rawNode.appendChild(_32);s.defNode=_32;s._parent=d.byId(_2f);s._parent.appendChild(s.rawNode);return s;};_7.Font={_setFont:function(){var f=this.fontStyle;this.rawNode.setAttribute("font-style",f.style);this.rawNode.setAttribute("font-variant",f.variant);this.rawNode.setAttribute("font-weight",f.weight);this.rawNode.setAttribute("font-size",f.size);this.rawNode.setAttribute("font-family",f.family);}};_7.Container={_init:function(){gs.Container._init.call(this);},add:function(_33){if(this!=_33.getParent()){this.rawNode.appendChild(_33.rawNode);gs.Container.add.apply(this,arguments);}return this;},remove:function(_34,_35){if(this==_34.getParent()){if(this.rawNode==_34.rawNode.parentNode){this.rawNode.removeChild(_34.rawNode);}gs.Container.remove.apply(this,arguments);}return this;},clear:function(){var r=this.rawNode;while(r.lastChild){r.removeChild(r.lastChild);}var _36=this.defNode;if(_36){while(_36.lastChild){_36.removeChild(_36.lastChild);}r.appendChild(_36);}return gs.Container.clear.apply(this,arguments);},_moveChildToFront:gs.Container._moveChildToFront,_moveChildToBack:gs.Container._moveChildToBack};d.mixin(gs.Creator,{createObject:function(_37,_38){if(!this.rawNode){return null;}var _39=new _37(),_3a=_8(_7.xmlns.svg,_37.nodeType);_39.setRawNode(_3a);this.rawNode.appendChild(_3a);_39.setShape(_38);this.add(_39);return _39;}});d.extend(g.Text,_7.Font);d.extend(g.TextPath,_7.Font);d.extend(g.Group,_7.Container);d.extend(g.Group,gs.Creator);d.extend(g.Surface,_7.Container);d.extend(g.Surface,gs.Creator);})();}}};});