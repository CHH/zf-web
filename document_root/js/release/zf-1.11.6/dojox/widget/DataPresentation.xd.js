/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.widget.DataPresentation"],["require","dojox.grid.DataGrid"],["require","dojox.charting.Chart2D"],["require","dojox.charting.widget.Legend"],["require","dojox.charting.action2d.Tooltip"],["require","dojox.charting.action2d.Highlight"],["require","dojo.colors"],["require","dojo.data.ItemFileWriteStore"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.widget.DataPresentation"]){_4._hasResource["dojox.widget.DataPresentation"]=true;_4.provide("dojox.widget.DataPresentation");_4.experimental("dojox.widget.DataPresentation");_4.require("dojox.grid.DataGrid");_4.require("dojox.charting.Chart2D");_4.require("dojox.charting.widget.Legend");_4.require("dojox.charting.action2d.Tooltip");_4.require("dojox.charting.action2d.Highlight");_4.require("dojo.colors");_4.require("dojo.data.ItemFileWriteStore");(function(){var _7=function(_8,_9,_a,_b,_c){var _d=[],_e=_9;_d[0]={value:0,text:""};var _f=_8.slice(0);if(_a){_f.reverse();}var _10=_f.length;if((_b!=="ClusteredBars")&&(_b!=="StackedBars")){var _11=_c.offsetWidth;var tmp=(""+_f[0]).length*_f.length*7;if(_e==1){for(var z=1;z<500;++z){if((tmp/z)<_11){break;}++_e;}}}for(var i=0;i<_10;i++){if(i%_e==0){_d.push({value:(i+1),text:_f[i]});}else{_d.push({value:(i+1),text:""});}}_d.push({value:(_10+1),text:""});return _d;};var _12=function(_13,_14){var _15={vertical:false,labels:_14,min:0,max:_14.length-1,majorTickStep:1,minorTickStep:1};if((_13==="ClusteredBars")||(_13==="StackedBars")){_15.vertical=true;}if((_13==="Lines")||(_13==="Areas")||(_13==="StackedAreas")){_15.min++;_15.max--;}return _15;};var _16=function(_17,_18,_19,_1a){var _1b={vertical:true,fixLower:"major",fixUpper:"major",natural:true};if(_18==="secondary"){_1b.leftBottom=false;}if((_17==="ClusteredBars")||(_17==="StackedBars")){_1b.vertical=false;}if(_19==_1a){_1b.min=_19-1;_1b.max=_1a+1;}return _1b;};var _1c=function(_1d,_1e,_1f){var _20={type:_1d,hAxis:"independent",vAxis:"dependent-"+_1e,gap:4,lines:false,areas:false,markers:false};if((_1d==="ClusteredBars")||(_1d==="StackedBars")){_20.hAxis=_20.vAxis;_20.vAxis="independent";}if((_1d==="Lines")||(_1d==="Hybrid-Lines")||(_1d==="Areas")||(_1d==="StackedAreas")){_20.lines=true;}if((_1d==="Areas")||(_1d==="StackedAreas")){_20.areas=true;}if(_1d==="Lines"){_20.markers=true;}if(_1d==="Hybrid-Lines"){_20.shadows={dx:2,dy:2,dw:2};_20.type="Lines";}if(_1d==="Hybrid-ClusteredColumns"){_20.type="ClusteredColumns";}if(_1f){_20.animate=_1f;}return _20;};var _21=function(_22,_23,_24,_25,_26,_27,_28,_29,_2a,_2b){var _2c=_23;if(!_2c){_22.innerHTML="";_2c=new _6.charting.Chart2D(_22);}if(_28){_28._clone=function(){var _2d=new _6.charting.Theme({chart:this.chart,plotarea:this.plotarea,axis:this.axis,series:this.series,marker:this.marker,antiAlias:this.antiAlias,assignColors:this.assignColors,assignMarkers:this.assigneMarkers,colors:_4.delegate(this.colors)});_2d.markers=this.markers;_2d._buildMarkerArray();return _2d;};_2c.setTheme(_28);}var _2e=_7(_29.series_data[0],_27,_25,_24,_22);var _2f={};var _30=null;var _31=null;var _32=_29.series_name.length;for(var i=0;i<_32;i++){if(_29.series_chart[i]&&(_29.series_data[i].length>0)){var _33=_24;var _34=_29.series_axis[i];if(_33=="Hybrid"){if(_29.series_charttype[i]=="line"){_33="Hybrid-Lines";}else{_33="Hybrid-ClusteredColumns";}}if(!_2f[_34]){_2f[_34]={};}if(!_2f[_34][_33]){var _35=_34+"-"+_33;_2c.addPlot(_35,_1c(_33,_34,_26));new _6.charting.action2d.Tooltip(_2c,_35);if((_33!=="Lines")&&(_33!=="Hybrid-Lines")){new _6.charting.action2d.Highlight(_2c,_35);}_2f[_34][_33]=true;}var _36=[];var _37=_29.series_data[i].length;for(var j=0;j<_37;j++){var val=_29.series_data[i][j];_36.push(val);if(_30===null||val>_30){_30=val;}if(_31===null||val<_31){_31=val;}}if(_25){_36.reverse();}var _38={plot:_34+"-"+_33};if(_29.series_linestyle[i]){_38.stroke={style:_29.series_linestyle[i]};}_2c.addSeries(_29.series_name[i],_36,_38);}}_2c.addAxis("independent",_12(_24,_2e));_2c.addAxis("dependent-primary",_16(_24,"primary",_31,_30));_2c.addAxis("dependent-secondary",_16(_24,"secondary",_31,_30));_2c.render();return _2c;};var _39=function(_3a,_3b,_3c,_3d){var _3e=_3b;if(!_3e){if(_3d){_3e=new _6.charting.widget.Legend({chart:_3c,horizontal:false},_3a);}else{_3e=new _6.charting.widget.Legend({chart:_3c,vertical:false},_3a);}}return _3e;};var _3f=function(_40,_41,_42,_43,_44){var _45=_41||new _6.grid.DataGrid({},_40);_45.startup();_45.setStore(_42,_43,_44);var _46=[];for(var ser=0;ser<_42.series_name.length;ser++){if(_42.series_grid[ser]&&(_42.series_data[ser].length>0)){_46.push({field:"data."+ser,name:_42.series_name[ser],width:"auto",formatter:_42.series_gridformatter[ser]});}}_45.setStructure(_46);_45.render();return _45;};var _47=function(_48,_49){if(_49.title){_48.innerHTML=_49.title;}};var _4a=function(_4b,_4c){if(_4c.footer){_4b.innerHTML=_4c.footer;}};var _4d=function(_4e,_4f){var _50=_4e;if(_4f){var _51=_4f.split(/[.\[\]]+/);for(var _52 in _51){if(_50){_50=_50[_51[_52]];}}}return _50;};_4.declare("dojox.widget.DataPresentation",null,{type:"chart",chartType:"clusteredBars",reverse:false,animate:null,labelMod:1,legendVertical:false,constructor:function(_53,_54){_4.mixin(this,_54);this.domNode=_4.byId(_53);this[this.type+"Node"]=this.domNode;if(typeof this.theme=="string"){this.theme=_4.getObject(this.theme);}this.chartNode=_4.byId(this.chartNode);this.legendNode=_4.byId(this.legendNode);this.gridNode=_4.byId(this.gridNode);this.titleNode=_4.byId(this.titleNode);this.footerNode=_4.byId(this.footerNode);if(this.url){this.setURL(null,this.refreshInterval);}else{if(this.data){this.setData(null,this.refreshInterval);}else{this.setStore();}}},setURL:function(url,_55){if(_55){this.cancelRefresh();}this.url=url||this.url;this.refreshInterval=_55||this.refreshInterval;var me=this;_4.xhrGet({url:this.url,handleAs:"json-comment-optional",load:function(_56,_57){me.setData(_56);},error:function(xhr,_58){if(me.urlError&&(typeof me.urlError=="function")){me.urlError(xhr,_58);}}});if(_55&&(this.refreshInterval>0)){this.refreshIntervalPending=setInterval(function(){me.setURL();},this.refreshInterval);}},setData:function(_59,_5a){if(_5a){this.cancelRefresh();}this.data=_59||this.data;this.refreshInterval=_5a||this.refreshInterval;var _5b=(typeof this.series=="function")?this.series(this.data):this.series;var _5c=[],_5d=[],_5e=[],_5f=[],_60=[],_61=[],_62=[],_63=[],_64=[],_65=0;for(var ser=0;ser<_5b.length;ser++){_5c[ser]=_4d(this.data,_5b[ser].datapoints);if(_5c[ser]&&(_5c[ser].length>_65)){_65=_5c[ser].length;}_5d[ser]=[];_5e[ser]=_5b[ser].name||(_5b[ser].namefield?_4d(this.data,_5b[ser].namefield):null)||("series "+ser);_5f[ser]=(_5b[ser].chart!==false);_60[ser]=_5b[ser].charttype||"bar";_61[ser]=_5b[ser].linestyle;_62[ser]=_5b[ser].axis||"primary";_63[ser]=(_5b[ser].grid!==false);_64[ser]=_5b[ser].gridformatter;}var _66,_67,_68,_69;var _6a=[];for(_66=0;_66<_65;_66++){_67={index:_66};for(ser=0;ser<_5b.length;ser++){if(_5c[ser]&&(_5c[ser].length>_66)){_68=_4d(_5c[ser][_66],_5b[ser].field);if(_5f[ser]){_69=parseFloat(_68);if(!isNaN(_69)){_68=_69;}}_67["data."+ser]=_68;_5d[ser].push(_68);}}_6a.push(_67);}if(_65<=0){_6a.push({index:0});}var _6b=new _4.data.ItemFileWriteStore({data:{identifier:"index",items:_6a}});if(this.data.title){_6b.title=this.data.title;}if(this.data.footer){_6b.footer=this.data.footer;}_6b.series_data=_5d;_6b.series_name=_5e;_6b.series_chart=_5f;_6b.series_charttype=_60;_6b.series_linestyle=_61;_6b.series_axis=_62;_6b.series_grid=_63;_6b.series_gridformatter=_64;this.setPreparedStore(_6b);if(_5a&&(this.refreshInterval>0)){var me=this;this.refreshIntervalPending=setInterval(function(){me.setData();},this.refreshInterval);}},refresh:function(){if(this.url){this.setURL(this.url,this.refreshInterval);}else{if(this.data){this.setData(this.data,this.refreshInterval);}}},cancelRefresh:function(){if(this.refreshIntervalPending){clearInterval(this.refreshIntervalPending);this.refreshIntervalPending=undefined;}},setStore:function(_6c,_6d,_6e){this.setPreparedStore(_6c,_6d,_6e);},setPreparedStore:function(_6f,_70,_71){this.preparedstore=_6f||this.store;this.query=_70||this.query;this.queryOptions=_71||this.queryOptions;if(this.preparedstore){if(this.chartNode){this.chartWidget=_21(this.chartNode,this.chartWidget,this.chartType,this.reverse,this.animate,this.labelMod,this.theme,this.preparedstore,this.query,this,_71);}if(this.legendNode){this.legendWidget=_39(this.legendNode,this.legendWidget,this.chartWidget,this.legendVertical);}if(this.gridNode){this.gridWidget=_3f(this.gridNode,this.gridWidget,this.preparedstore,this.query,this.queryOptions);}if(this.titleNode){_47(this.titleNode,this.preparedstore);}if(this.footerNode){_4a(this.footerNode,this.preparedstore);}}},getChartWidget:function(){return this.chartWidget;},getGridWidget:function(){return this.gridWidget;},destroy:function(){this.cancelRefresh();if(this.chartWidget){this.chartWidget.destroy();this.chartWidget=undefined;}if(this.legendWidget){this.legendWidget=undefined;}if(this.gridWidget){this.gridWidget=undefined;}if(this.chartNode){this.chartNode.innerHTML="";}if(this.legendNode){this.legendNode.innerHTML="";}if(this.gridNode){this.gridNode.innerHTML="";}if(this.titleNode){this.titleNode.innerHTML="";}if(this.footerNode){this.footerNode.innerHTML="";}}});})();}}};});