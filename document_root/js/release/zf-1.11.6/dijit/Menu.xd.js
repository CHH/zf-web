/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit.Menu"],["require","dijit._Widget"],["require","dijit._KeyNavContainer"],["require","dijit._Templated"],["require","dijit.MenuItem"],["require","dijit.PopupMenuItem"],["require","dijit.CheckedMenuItem"],["require","dijit.MenuSeparator"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit.Menu"]){_4._hasResource["dijit.Menu"]=true;_4.provide("dijit.Menu");_4.require("dijit._Widget");_4.require("dijit._KeyNavContainer");_4.require("dijit._Templated");_4.declare("dijit._MenuBase",[_5._Widget,_5._Templated,_5._KeyNavContainer],{parentMenu:null,popupDelay:500,startup:function(){if(this._started){return;}_4.forEach(this.getChildren(),function(_7){_7.startup();});this.startupKeyNavChildren();this.inherited(arguments);},onExecute:function(){},onCancel:function(_8){},_moveToPopup:function(_9){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(_9);}else{var _a=this._getTopMenu();if(_a&&_a._isMenuBar){_a.focusNext();}}},_onPopupHover:function(_b){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _c=this.currentPopup.parentMenu;if(_c.focusedChild){_c.focusedChild._setSelected(false);}_c.focusedChild=this.currentPopup.from_item;_c.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(_d){if(this.isActive){this.focusChild(_d);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(_4.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(_d);}this._hoveredChild=_d;},_onChildBlur:function(_e){this._stopPopupTimer();_e._setSelected(false);var _f=_e.popup;if(_f){this._stopPendingCloseTimer(_f);_f._pendingClose_timer=setTimeout(function(){_f._pendingClose_timer=null;if(_f.parentMenu){_f.parentMenu.currentPopup=null;}_5.popup.close(_f);},this.popupDelay);}},onItemUnhover:function(_10){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==_10){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_11){if(_11._pendingClose_timer){clearTimeout(_11._pendingClose_timer);_11._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(_12,evt){if(_12.disabled){return false;}if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(_12);if(_12.popup){this._openPopup();}else{this.onExecute();_12.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _13=this.focusedChild;if(!_13){return;}var _14=_13.popup;if(_14.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);_5.popup.close(this.currentPopup);}_14.parentMenu=this;_14.from_item=_13;var _15=this;_5.popup.open({parent:this,popup:_14,around:_13.domNode,orient:this._orient||(this.isLeftToRight()?{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"}:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"}),onCancel:function(){_15.focusChild(_13);_15._cleanUp();_13._setSelected(true);_15.focusedChild=_13;},onExecute:_4.hitch(this,"_cleanUp")});this.currentPopup=_14;_14.connect(_14.domNode,"onmouseenter",_4.hitch(_15,"_onPopupHover"));if(_14.focus){_14._focus_timer=setTimeout(_4.hitch(_14,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;_4.addClass(this.domNode,"dijitMenuActive");_4.removeClass(this.domNode,"dijitMenuPassive");},onOpen:function(e){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_4.removeClass(this.domNode,"dijitMenuActive");_4.addClass(this.domNode,"dijitMenuPassive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}if(this.currentPopup){_5.popup.close(this.currentPopup);this.currentPopup=null;}},_onItemFocus:function(_16){if(this._hoveredChild&&this._hoveredChild!=_16){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});_4.declare("dijit.Menu",_5._MenuBase,{constructor:function(){this._bindings=[];},templateString:_4.cache("dijit","templates/Menu.html","<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" waiRole=\"menu\" tabIndex=\"${tabIndex}\" dojoAttachEvent=\"onkeypress:_onKeyPress\">\n\t<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>\n</table>\n"),targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(_4.body());}else{_4.forEach(this.targetNodeIds,this.bindDomNode,this);}var k=_4.keys,l=this.isLeftToRight();this._openSubMenuKey=l?k.RIGHT_ARROW:k.LEFT_ARROW;this._closeSubMenuKey=l?k.LEFT_ARROW:k.RIGHT_ARROW;this.connectKeyNavHandlers([k.UP_ARROW],[k.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_4.stopEvent(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_4.stopEvent(evt);}break;}},_iframeContentWindow:function(_17){var win=_5.getDocumentWindow(this._iframeContentDocument(_17))||this._iframeContentDocument(_17)["__parent__"]||(_17.name&&_4.doc.frames[_17.name])||null;return win;},_iframeContentDocument:function(_18){var doc=_18.contentDocument||(_18.contentWindow&&_18.contentWindow.document)||(_18.name&&_4.doc.frames[_18.name]&&_4.doc.frames[_18.name].document)||null;return doc;},bindDomNode:function(_19){_19=_4.byId(_19);var cn;if(_19.tagName.toLowerCase()=="iframe"){var _1a=_19,win=this._iframeContentWindow(_1a);cn=_4.withGlobal(win,_4.body);}else{cn=(_19==_4.body()?_4.doc.documentElement:_19);}var _1b={node:_19,iframe:_1a};_4.attr(_19,"_dijitMenu"+this.id,this._bindings.push(_1b));var _1c=_4.hitch(this,function(cn){return [_4.connect(cn,this.leftClickToOpen?"onclick":"oncontextmenu",this,function(evt){_4.stopEvent(evt);this._scheduleOpen(evt.target,_1a,{x:evt.pageX,y:evt.pageY});}),_4.connect(cn,"onkeydown",this,function(evt){if(evt.shiftKey&&evt.keyCode==_4.keys.F10){_4.stopEvent(evt);this._scheduleOpen(evt.target,_1a);}})];});_1b.connects=cn?_1c(cn):[];if(_1a){_1b.onloadHandler=_4.hitch(this,function(){var win=this._iframeContentWindow(_1a);cn=_4.withGlobal(win,_4.body);_1b.connects=_1c(cn);});if(_1a.addEventListener){_1a.addEventListener("load",_1b.onloadHandler,false);}else{_1a.attachEvent("onload",_1b.onloadHandler);}}},unBindDomNode:function(_1d){var _1e;try{_1e=_4.byId(_1d);}catch(e){return;}var _1f="_dijitMenu"+this.id;if(_1e&&_4.hasAttr(_1e,_1f)){var bid=_4.attr(_1e,_1f)-1,b=this._bindings[bid];_4.forEach(b.connects,_4.disconnect);var _20=b.iframe;if(_20){if(_20.removeEventListener){_20.removeEventListener("load",b.onloadHandler,false);}else{_20.detachEvent("onload",b.onloadHandler);}}_4.removeAttr(_1e,_1f);delete this._bindings[bid];}},_scheduleOpen:function(_21,_22,_23){if(!this._openTimer){this._openTimer=setTimeout(_4.hitch(this,function(){delete this._openTimer;this._openMyself({target:_21,iframe:_22,coords:_23});}),1);}},_openMyself:function(_24){var _25=_24.target,_26=_24.iframe,_27=_24.coords;if(_27){if(_26){var od=_25.ownerDocument,ifc=_4.position(_26,true),win=this._iframeContentWindow(_26),_28=_4.withGlobal(win,"_docScroll",_4);var cs=_4.getComputedStyle(_26),tp=_4._toPixelValue,_29=(_4.isIE&&_4.isQuirks?0:tp(_26,cs.paddingLeft))+(_4.isIE&&_4.isQuirks?tp(_26,cs.borderLeftWidth):0),top=(_4.isIE&&_4.isQuirks?0:tp(_26,cs.paddingTop))+(_4.isIE&&_4.isQuirks?tp(_26,cs.borderTopWidth):0);_27.x+=ifc.x+_29-_28.x;_27.y+=ifc.y+top-_28.y;}}else{_27=_4.position(_25,true);_27.x+=10;_27.y+=10;}var _2a=this;var _2b=_5.getFocus(this);function _2c(){if(_2a.refocus){_5.focus(_2b);}_5.popup.close(_2a);};_5.popup.open({popup:this,x:_27.x,y:_27.y,onExecute:_2c,onCancel:_2c,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);_5.popup.close(this);};},uninitialize:function(){_4.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});_4.require("dijit.MenuItem");_4.require("dijit.PopupMenuItem");_4.require("dijit.CheckedMenuItem");_4.require("dijit.MenuSeparator");}}};});