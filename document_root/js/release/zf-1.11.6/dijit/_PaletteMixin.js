/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dijit._PaletteMixin"]){dojo._hasResource["dijit._PaletteMixin"]=true;dojo.provide("dijit._PaletteMixin");dojo.require("dijit._CssStateMixin");dojo.declare("dijit._PaletteMixin",[dijit._CssStateMixin],{defaultTimeout:500,timeoutChangeRate:0.9,value:null,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:"",_preparePalette:function(_1,_2){this._cells=[];var _3=this._blankGif;var _4=dojo.getObject(this.dyeClass);for(var _5=0;_5<_1.length;_5++){var _6=dojo.create("tr",{tabIndex:"-1"},this.gridNode);for(var _7=0;_7<_1[_5].length;_7++){var _8=_1[_5][_7];if(_8){var _9=new _4(_8);var _a=dojo.create("td",{"class":this.cellClass,tabIndex:"-1",title:_2[_8]});_9.fillCell(_a,_3);this.connect(_a,"ondijitclick","_onCellClick");this._trackMouseState(_a,this.cellClass);dojo.place(_a,_6);_a.index=this._cells.length;this._cells.push({node:_a,dye:_9});}}}this._xDim=_1[0].length;this._yDim=_1.length;var _b={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:1,LEFT_ARROW:-1};for(var _c in _b){this._connects.push(dijit.typematic.addKeyListener(this.domNode,{charOrCode:dojo.keys[_c],ctrlKey:false,altKey:false,shiftKey:false},this,function(){var _d=_b[_c];return function(_e){this._navigateByKey(_d,_e);};}(),this.timeoutChangeRate,this.defaultTimeout));}},postCreate:function(){this.inherited(arguments);this._currentFocus=this._cells[0].node;dojo.attr(this._currentFocus,"tabIndex",this.tabIndex);},focus:function(){dijit.focus(this._currentFocus);},_onBlur:function(){dojo.attr(this._currentFocus,"tabIndex","-1");this._currentFocus=this._cells[0].node;dojo.attr(this._currentFocus,"tabIndex",this.tabIndex);this.inherited(arguments);},_onCellClick:function(_f){var _10=_f.currentTarget;this._selectCell(_10);dojo.stopEvent(_f);},_setCurrent:function(_11){if("_currentFocus" in this){dojo.attr(this._currentFocus,"tabIndex","-1");}this._currentFocus=_11;if(_11){dojo.attr(_11,"tabIndex",this.tabIndex);}},_selectCell:function(_12){var dye=this._getDye(_12);this.onChange(this.value=dye.getValue());},onChange:function(_13){},_navigateByKey:function(_14,_15){if(_15==-1){return;}var _16=this._currentFocus.index+_14;if(_16<this._cells.length&&_16>-1){var _17=this._cells[_16].node;this._setCurrent(_17);setTimeout(dojo.hitch(dijit,"focus",_17),0);}},_getDye:function(_18){return this._cells[_18.index].dye;}});}