/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._TimePicker"],["require","dijit.form._FormWidget"],["require","dojo.date.locale"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._TimePicker"]){_4._hasResource["dijit._TimePicker"]=true;_4.provide("dijit._TimePicker");_4.require("dijit.form._FormWidget");_4.require("dojo.date.locale");_4.declare("dijit._TimePicker",[_5._Widget,_5._Templated],{templateString:_4.cache("dijit","templates/TimePicker.html","<div id=\"widget_${id}\" class=\"dijitMenu ${baseClass}\"\n    ><div dojoAttachPoint=\"upArrow\" class=\"dijitButtonNode dijitUpArrowButton\" dojoAttachEvent=\"onmouseenter:_buttonMouse,onmouseleave:_buttonMouse\"\n\t\t><div class=\"dijitReset dijitInline dijitArrowButtonInner\" wairole=\"presentation\" role=\"presentation\">&nbsp;</div\n\t\t><div class=\"dijitArrowButtonChar\">&#9650;</div></div\n    ><div dojoAttachPoint=\"timeMenu,focusNode\" dojoAttachEvent=\"onclick:_onOptionSelected,onmouseover,onmouseout\"></div\n    ><div dojoAttachPoint=\"downArrow\" class=\"dijitButtonNode dijitDownArrowButton\" dojoAttachEvent=\"onmouseenter:_buttonMouse,onmouseleave:_buttonMouse\"\n\t\t><div class=\"dijitReset dijitInline dijitArrowButtonInner\" wairole=\"presentation\" role=\"presentation\">&nbsp;</div\n\t\t><div class=\"dijitArrowButtonChar\">&#9660;</div></div\n></div>\n"),baseClass:"dijitTimePicker",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",visibleRange:"T05:00:00",value:new Date(),_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:_4.date.stamp.toISOString,_filterString:"",setValue:function(_7){_4.deprecated("dijit._TimePicker:setValue() is deprecated.  Use attr('value') instead.","","2.0");this.attr("value",_7);},_setValueAttr:function(_8){this.value=_8;this._showText();},onOpen:function(_9){if(this._beenOpened&&this.domNode.parentNode){var p=_5.byId(this.domNode.parentNode.dijitPopupParent);if(p){var _a=p.attr("displayedValue");if(_a&&!p.parse(_a,p.constraints)){this._filterString=_a;}else{this._filterString="";}this._showText();}}this._beenOpened=true;},isDisabledDate:function(_b,_c){return false;},_getFilteredNodes:function(_d,_e,_f){var _10=[],n,i=_d,max=this._maxIncrement+Math.abs(i),chk=_f?-1:1,dec=_f?1:0,inc=_f?0:1;do{i=i-dec;n=this._createOption(i);if(n){_10.push(n);}i=i+inc;}while(_10.length<_e&&(i*chk)<max);if(_f){_10.reverse();}return _10;},_showText:function(){this.timeMenu.innerHTML="";var _11=_4.date.stamp.fromISOString;this._clickableIncrementDate=_11(this.clickableIncrement);this._visibleIncrementDate=_11(this.visibleIncrement);this._visibleRangeDate=_11(this.visibleRange);var _12=function(_13){return _13.getHours()*60*60+_13.getMinutes()*60+_13.getSeconds();};var _14=_12(this._clickableIncrementDate);var _15=_12(this._visibleIncrementDate);var _16=_12(this._visibleRangeDate);var _17=this.value.getTime();this._refDate=new Date(_17-_17%(_15*1000));this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._totalIncrements=_16/_14;this._visibleIncrement=_15/_14;this._maxIncrement=(60*60*24)/_14;var _18=this._getFilteredNodes(0,this._totalIncrements>>1,true);var _19=this._getFilteredNodes(0,this._totalIncrements>>1,false);if(_18.length<this._totalIncrements>>1){_18=_18.slice(_18.length/2);_19=_19.slice(0,_19.length/2);}_4.forEach(_18.concat(_19),function(n){this.timeMenu.appendChild(n);},this);},postCreate:function(){if(this.constraints===_5._TimePicker.prototype.constraints){this.constraints={};}_4.mixin(this,this.constraints);if(!this.constraints.locale){this.constraints.locale=this.lang;}this.connect(this.timeMenu,_4.isIE?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var _1a=this;var _1b=function(){_1a._connects.push(_5.typematic.addMouseListener.apply(null,arguments));};_1b(this.upArrow,this,this._onArrowUp,1,50);_1b(this.downArrow,this,this._onArrowDown,1,50);var _1c=function(cb){return function(cnt){if(cnt>0){cb.call(this,arguments);}};};var _1d=function(_1e,cb){return function(e){_4.stopEvent(e);_5.typematic.trigger(e,this,_1e,_1c(cb),_1e,1,50);};};this.connect(this.upArrow,"onmouseover",_1d(this.upArrow,this._onArrowUp));this.connect(this.downArrow,"onmouseover",_1d(this.downArrow,this._onArrowDown));this.inherited(arguments);},_buttonMouse:function(e){_4.toggleClass(e.currentTarget,"dijitButtonNodeHover",e.type=="mouseover");},_createOption:function(_1f){var _20=new Date(this._refDate);var _21=this._clickableIncrementDate;_20.setHours(_20.getHours()+_21.getHours()*_1f,_20.getMinutes()+_21.getMinutes()*_1f,_20.getSeconds()+_21.getSeconds()*_1f);if(this.constraints.selector=="time"){_20.setFullYear(1970,0,1);}var _22=_4.date.locale.format(_20,this.constraints);if(this._filterString&&_22.toLowerCase().indexOf(this._filterString)!==0){return null;}var div=_4.create("div",{"class":this.baseClass+"Item"});div.date=_20;div.index=_1f;_4.create("div",{"class":this.baseClass+"ItemInner",innerHTML:_22},div);if(_1f%this._visibleIncrement<1&&_1f%this._visibleIncrement>-1){_4.addClass(div,this.baseClass+"Marker");}else{if(!(_1f%this._clickableIncrement)){_4.addClass(div,this.baseClass+"Tick");}}if(this.isDisabledDate(_20)){_4.addClass(div,this.baseClass+"ItemDisabled");}if(!_4.date.compare(this.value,_20,this.constraints.selector)){div.selected=true;_4.addClass(div,this.baseClass+"ItemSelected");if(_4.hasClass(div,this.baseClass+"Marker")){_4.addClass(div,this.baseClass+"MarkerSelected");}else{_4.addClass(div,this.baseClass+"TickSelected");}}return div;},_onOptionSelected:function(tgt){var _23=tgt.target.date||tgt.target.parentNode.date;if(!_23||this.isDisabledDate(_23)){return;}this._highlighted_option=null;this.attr("value",_23);this.onValueSelected(_23);},onValueSelected:function(_24){},_highlightOption:function(_25,_26){if(!_25){return;}if(_26){if(this._highlighted_option){this._highlightOption(this._highlighted_option,false);}this._highlighted_option=_25;}else{if(this._highlighted_option!==_25){return;}else{this._highlighted_option=null;}}_4.toggleClass(_25,this.baseClass+"ItemHover",_26);if(_4.hasClass(_25,this.baseClass+"Marker")){_4.toggleClass(_25,this.baseClass+"MarkerHover",_26);}else{_4.toggleClass(_25,this.baseClass+"TickHover",_26);}},onmouseover:function(e){this._keyboardSelected=null;var tgr=(e.target.parentNode===this.timeMenu)?e.target:e.target.parentNode;if(!_4.hasClass(tgr,this.baseClass+"Item")){return;}this._highlightOption(tgr,true);},onmouseout:function(e){this._keyboardSelected=null;var tgr=(e.target.parentNode===this.timeMenu)?e.target:e.target.parentNode;this._highlightOption(tgr,false);},_mouseWheeled:function(e){this._keyboardSelected=null;_4.stopEvent(e);var _27=(_4.isIE?e.wheelDelta:-e.detail);this[(_27>0?"_onArrowUp":"_onArrowDown")]();},_onArrowUp:function(_28){if(typeof _28=="number"&&_28==-1){return;}if(!this.timeMenu.childNodes.length){return;}var _29=this.timeMenu.childNodes[0].index;var _2a=this._getFilteredNodes(_29,1,true);if(_2a.length){this.timeMenu.removeChild(this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]);this.timeMenu.insertBefore(_2a[0],this.timeMenu.childNodes[0]);}},_onArrowDown:function(_2b){if(typeof _2b=="number"&&_2b==-1){return;}if(!this.timeMenu.childNodes.length){return;}var _2c=this.timeMenu.childNodes[this.timeMenu.childNodes.length-1].index+1;var _2d=this._getFilteredNodes(_2c,1,false);if(_2d.length){this.timeMenu.removeChild(this.timeMenu.childNodes[0]);this.timeMenu.appendChild(_2d[0]);}},handleKey:function(e){var dk=_4.keys;if(e.keyChar||e.charOrCode===dk.BACKSPACE||e.charOrCode==dk.DELETE){setTimeout(_4.hitch(this,function(){this._filterString=e.target.value.toLowerCase();this._showText();}),1);}else{if(e.charOrCode==dk.DOWN_ARROW||e.charOrCode==dk.UP_ARROW){_4.stopEvent(e);if(this._highlighted_option&&!this._highlighted_option.parentNode){this._highlighted_option=null;}var _2e=this.timeMenu,tgt=this._highlighted_option||_4.query("."+this.baseClass+"ItemSelected",_2e)[0];if(!tgt){tgt=_2e.childNodes[0];}else{if(_2e.childNodes.length){if(e.charOrCode==dk.DOWN_ARROW&&!tgt.nextSibling){this._onArrowDown();}else{if(e.charOrCode==dk.UP_ARROW&&!tgt.previousSibling){this._onArrowUp();}}if(e.charOrCode==dk.DOWN_ARROW){tgt=tgt.nextSibling;}else{tgt=tgt.previousSibling;}}}this._highlightOption(tgt,true);this._keyboardSelected=tgt;}else{if(this._highlighted_option&&(e.charOrCode==dk.ENTER||e.charOrCode===dk.TAB)){if(!this._keyboardSelected&&e.charOrCode===dk.TAB){return;}if(e.charOrCode==dk.ENTER){_4.stopEvent(e);}this._onOptionSelected({target:this._highlighted_option});}}}}});}}};});