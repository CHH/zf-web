/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._editor.plugins.FullScreen"],["require","dijit._editor._Plugin"],["require","dijit.form.Button"],["require","dojo.i18n"],["requireLocalization","dijit._editor","commands",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._editor.plugins.FullScreen"]){_4._hasResource["dijit._editor.plugins.FullScreen"]=true;_4.provide("dijit._editor.plugins.FullScreen");_4.require("dijit._editor._Plugin");_4.require("dijit.form.Button");_4.require("dojo.i18n");_4.declare("dijit._editor.plugins.FullScreen",_5._editor._Plugin,{zIndex:500,_origState:null,_origiFrameState:null,_resizeHandle:null,isFullscreen:false,toggle:function(){this.button.attr("checked",!this.button.attr("checked"));},_initButton:function(){var _7=_4.i18n.getLocalization("dijit._editor","commands");this.button=new _5.form.ToggleButton({label:_7["fullScreen"],showLabel:false,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"FullScreen",tabIndex:"-1",onChange:_4.hitch(this,"_setFullScreen")});},setEditor:function(_8){this.editor=_8;this._initButton();this.editor.addKeyHandler(_4.keys.F11,true,true,_4.hitch(this,function(e){this.toggle();_4.stopEvent(e);setTimeout(_4.hitch(this,function(){this.editor.focus();}),250);return true;}));this.connect(this.editor.domNode,"onkeydown","_containFocus");},_containFocus:function(e){if(this.isFullscreen){var ed=this.editor;if(!ed.isTabIndent&&ed._fullscreen_oldOnKeyDown&&e.keyCode===_4.keys.TAB){var f=_5.getFocus();var _9=this._getAltViewNode();if(f.node==ed.iframe||(_9&&f.node===_9)){setTimeout(_4.hitch(this,function(){ed.toolbar.focus();}),10);}else{if(_9&&_4.style(ed.iframe,"display")==="none"){setTimeout(_4.hitch(this,function(){_5.focus(_9);}),10);}else{setTimeout(_4.hitch(this,function(){ed.focus();}),10);}}_4.stopEvent(e);}else{if(ed._fullscreen_oldOnKeyDown){ed._fullscreen_oldOnKeyDown(e);}}}},_resizeEditor:function(){var vp=_5.getViewport();_4.marginBox(this.editor.domNode,{w:vp.w,h:vp.h});var _a=this.editor.getHeaderHeight();var _b=this.editor.getFooterHeight();var _c=_4._getPadBorderExtents(this.editor.domNode);var _d=_4._getPadBorderExtents(this.editor.iframe.parentNode);var _e=_4._getMarginExtents(this.editor.iframe.parentNode);var _f=vp.h-(_a+_c.h+_b);_4.marginBox(this.editor.iframe.parentNode,{h:_f,w:vp.w});_4.marginBox(this.editor.iframe,{h:_f-(_d.h+_e.h)});},_getAltViewNode:function(){},_setFullScreen:function(_10){var vp=_5.getViewport();var ed=this.editor;var _11=_4.body();var _12=ed.domNode.parentNode;this.isFullscreen=_10;if(_10){while(_12&&_12!==_4.body()){_4.addClass(_12,"dijitForceStatic");_12=_12.parentNode;}this._editorResizeHolder=this.editor.resize;ed.resize=function(){};ed._fullscreen_oldOnKeyDown=ed.onKeyDown;ed.onKeyDown=_4.hitch(this,this._containFocus);this._origState={};this._origiFrameState={};var _13=ed.domNode,_14=_13&&_13.style||{};this._origState={width:_14.width||"",height:_14.height||"",top:_4.style(_13,"top")||"",left:_4.style(_13,"left")||"",position:_4.style(_13,"position")||"static",marginBox:_4.marginBox(ed.domNode)};var _15=ed.iframe,_16=_15&&_15.style||{};var bc=_4.style(ed.iframe,"backgroundColor");this._origiFrameState={backgroundColor:bc||"transparent",width:_16.width||"auto",height:_16.height||"auto",zIndex:_16.zIndex||""};_4.style(ed.domNode,{position:"absolute",top:"0px",left:"0px",zIndex:this.zIndex,width:vp.w+"px",height:vp.h+"px"});_4.style(ed.iframe,{height:"100%",width:"100%",zIndex:this.zIndex,backgroundColor:bc!=="transparent"&&bc!=="rgba(0, 0, 0, 0)"?bc:"white"});_4.style(ed.iframe.parentNode,{height:"95%",width:"100%"});if(_11.style&&_11.style.overflow){this._oldOverflow=_4.style(_11,"overflow");}else{this._oldOverflow="";}if(_4.isIE&&!_4.isQuirks){if(_11.parentNode&&_11.parentNode.style&&_11.parentNode.style.overflow){this._oldBodyParentOverflow=_11.parentNode.style.overflow;}else{this._oldBodyParentOverflow="scroll";}_4.style(_11.parentNode,"overflow","hidden");}_4.style(_11,"overflow","hidden");var _17=function(){var vp=_5.getViewport();if("_prevW" in this&&"_prevH" in this){if(vp.w===this._prevW&&vp.h===this._prevH){return;}}else{this._prevW=vp.w;this._prevH=vp.h;}if(this._resizer){clearTimeout(this._resizer);delete this._resizer;}this._resizer=setTimeout(_4.hitch(this,function(){delete this._resizer;this._resizeEditor();}),10);};this._resizeHandle=_4.connect(window,"onresize",this,_17);this._resizeHandle2=_4.connect(ed,"resize",_4.hitch(this,function(){if(this._resizer){clearTimeout(this._resizer);delete this._resizer;}this._resizer=setTimeout(_4.hitch(this,function(){delete this._resizer;this._resizeEditor();}),10);}));this._resizeEditor();var dn=this.editor.toolbar.domNode;setTimeout(function(){_5.scrollIntoView(dn);},250);}else{if(this._resizeHandle){_4.disconnect(this._resizeHandle);this._resizeHandle=null;}if(this._resizeHandle2){_4.disconnect(this._resizeHandle2);this._resizeHandle2=null;}if(this._rst){clearTimeout(this._rst);this._rst=null;}while(_12&&_12!==_4.body()){_4.removeClass(_12,"dijitForceStatic");_12=_12.parentNode;}if(this._editorResizeHolder){this.editor.resize=this._editorResizeHolder;}if(!this._origState&&!this._origiFrameState){return;}if(ed._fullscreen_oldOnKeyDown){ed.onKeyDown=ed._fullscreen_oldOnKeyDown;delete ed._fullscreen_oldOnKeyDown;}var _18=this;setTimeout(function(){var mb=_18._origState.marginBox;var oh=_18._origState.height;if(_4.isIE&&!_4.isQuirks){_11.parentNode.style.overflow=_18._oldBodyParentOverflow;delete _18._oldBodyParentOverflow;}_4.style(_11,"overflow",_18._oldOverflow);delete _18._oldOverflow;_4.style(ed.domNode,_18._origState);_4.style(ed.iframe.parentNode,{height:"",width:""});_4.style(ed.iframe,_18._origiFrameState);delete _18._origState;delete _18._origiFrameState;var _19=_5.getEnclosingWidget(ed.domNode.parentNode);if(_19&&_19.resize){_19.resize();}else{if(!oh||oh.indexOf("%")<0){setTimeout(_4.hitch(this,function(){ed.resize({h:mb.h});}),0);}}_5.scrollIntoView(_18.editor.toolbar.domNode);},100);}},destroy:function(){if(this._resizeHandle){_4.disconnect(this._resizeHandle);this._resizeHandle=null;}if(this._resizeHandle2){_4.disconnect(this._resizeHandle2);this._resizeHandle2=null;}if(this._resizer){clearTimeout(this._resizer);this._resizer=null;}this.inherited(arguments);}});_4.subscribe(_5._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin){return;}var _1a=o.args.name.toLowerCase();if(_1a==="fullscreen"){o.plugin=new _5._editor.plugins.FullScreen({zIndex:("zIndex" in o.args)?o.args.zIndex:500});}});}}};});