/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._HasDropDown"],["require","dijit._base.place"],["require","dijit._Widget"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._HasDropDown"]){_4._hasResource["dijit._HasDropDown"]=true;_4.provide("dijit._HasDropDown");_4.require("dijit._base.place");_4.require("dijit._Widget");_4.declare("dijit._HasDropDown",null,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouse:function(e){if(e.type=="click"&&!this._seenKeydown){return;}this._seenKeydown=false;if(e.type=="mousedown"){this._docHandler=this.connect(_4.doc,"onmouseup","_onDropDownMouseup");}if(this.disabled||this.readOnly){return;}if(this._stopClickEvents){_4.stopEvent(e);}this.toggleDropDown();if(e.type=="click"||e.type=="keypress"){this._onDropDownMouseup();}},_onDropDownMouseup:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _7=this.dropDown,_8=false;if(e&&this._opened){var c=_4.position(this._buttonNode,true);if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){var t=e.target;while(t&&!_8){if(_4.hasClass(t,"dijitPopup")){_8=true;}else{t=t.parentNode;}}if(_8){t=e.target;if(_7.onItemClick){var _9;while(t&&!(_9=_5.byNode(t))){t=t.parentNode;}if(_9&&_9.onClick&&_9.getParent){_9.getParent().onItemClick(_9,e);}}return;}}}if(this._opened&&_7.focus){window.setTimeout(_4.hitch(_7,"focus"),1);}},_setupDropdown:function(){this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;this._aroundNode=this._aroundNode||this.domNode;this.connect(this._buttonNode,"onmousedown","_onDropDownMouse");this.connect(this._buttonNode,"onclick","_onDropDownMouse");this.connect(this._buttonNode,"onkeydown","_onDropDownKeydown");this.connect(this._buttonNode,"onblur","_onDropDownBlur");this.connect(this._buttonNode,"onkeypress","_onKey");if(this._setStateClass){this.connect(this,"openDropDown","_setStateClass");this.connect(this,"closeDropDown","_setStateClass");}var _a={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";_4.addClass(this._arrowWrapperNode||this._buttonNode,"dijit"+_a+"ArrowButton");},postCreate:function(){this._setupDropdown();this.inherited(arguments);},destroyDescendants:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onDropDownKeydown:function(e){this._seenKeydown=true;},_onKeyPress:function(e){if(this._opened&&e.charOrCode==_4.keys.ESCAPE&&!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.toggleDropDown();_4.stopEvent(e);return;}this.inherited(arguments);},_onDropDownBlur:function(e){this._seenKeydown=false;},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){return;}}if(d&&this._opened&&e.keyCode==_4.keys.ESCAPE){this.toggleDropDown();return;}if(e.keyCode==_4.keys.DOWN_ARROW||e.keyCode==_4.keys.ENTER||e.charOrCode==" "){this._onDropDownMouse(e);}},_onBlur:function(){this.closeDropDown();this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(_b){_b();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}this.focus();var _c=this.dropDown;if(!_c){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(_4.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var _d=this.dropDown;var _e=_d.domNode;var _f=this;if(!this._preparedNode){_5.popup.moveOffScreen(_e);this._preparedNode=true;if(_e.style.width){this._explicitDDWidth=true;}if(_e.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var _10={display:"",visibility:"hidden"};if(!this._explicitDDWidth){_10.width="";}if(!this._explicitDDHeight){_10.height="";}_4.style(_e,_10);var mb=_4.marginBox(_e);var _11=(this.maxHeight&&mb.h>this.maxHeight);_4.style(_e,{overflow:_11?"auto":"hidden"});if(this.forceWidth){mb.w=this.domNode.offsetWidth;}else{if(this.autoWidth){mb.w=Math.max(mb.w,this.domNode.offsetWidth);}else{delete mb.w;}}if(_11){mb.h=this.maxHeight;if("w" in mb){mb.w+=16;}}else{delete mb.h;}delete mb.t;delete mb.l;if(_4.isFunction(_d.resize)){_d.resize(mb);}else{_4.marginBox(_e,mb);}}var _12=_5.popup.open({parent:this,popup:_d,around:this._aroundNode,orient:_5.getPopupAroundAlignment((this.dropDownPosition&&this.dropDownPosition.length)?this.dropDownPosition:["below"],this.isLeftToRight()),onExecute:function(){_f.closeDropDown(true);},onCancel:function(){_f.closeDropDown(true);},onClose:function(){_4.attr(_f._popupStateNode,"popupActive",false);_4.removeClass(_f._popupStateNode,"dijitHasDropDownOpen");_f._opened=false;_f.state="";}});_4.attr(this._popupStateNode,"popupActive","true");_4.addClass(_f._popupStateNode,"dijitHasDropDownOpen");this._opened=true;this.state="Opened";return _12;},closeDropDown:function(_13){if(this._opened){_5.popup.close(this.dropDown);if(_13){this.focus();}this._opened=false;this.state="";}}});}}};});