/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.charting.axis2d.Default"],["require","dojox.charting.scaler.linear"],["require","dojox.charting.axis2d.common"],["require","dojox.charting.axis2d.Base"],["require","dojo.colors"],["require","dojo.string"],["require","dojox.gfx"],["require","dojox.lang.functional"],["require","dojox.lang.utils"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.charting.axis2d.Default"]){_4._hasResource["dojox.charting.axis2d.Default"]=true;_4.provide("dojox.charting.axis2d.Default");_4.require("dojox.charting.scaler.linear");_4.require("dojox.charting.axis2d.common");_4.require("dojox.charting.axis2d.Base");_4.require("dojo.colors");_4.require("dojo.string");_4.require("dojox.gfx");_4.require("dojox.lang.functional");_4.require("dojox.lang.utils");(function(){var dc=_6.charting,df=_6.lang.functional,du=_6.lang.utils,g=_6.gfx,_7=dc.scaler.linear,_8=4;_4.declare("dojox.charting.axis2d.Default",_6.charting.axis2d.Base,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,htmlLabels:true},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,stroke:{},majorTick:{},minorTick:{},microTick:{},font:"",fontColor:""},constructor:function(_9,_a){this.opt=_4.delegate(this.defaultParams,_a);du.updateWithPattern(this.opt,_a,this.optionalParams);},dependOnData:function(){return !("min" in this.opt)||!("max" in this.opt);},clear:function(){delete this.scaler;delete this.ticks;this.dirty=true;return this;},initialized:function(){return "scaler" in this&&!(this.dirty&&this.dependOnData());},setWindow:function(_b,_c){this.scale=_b;this.offset=_c;return this.clear();},getWindowScale:function(){return "scale" in this?this.scale:1;},getWindowOffset:function(){return "offset" in this?this.offset:0;},_groupLabelWidth:function(_d,_e){if(_d[0]["text"]){_d=df.map(_d,function(_f){return _f.text;});}var s=_d.join("<br>");return _6.gfx._base._getTextBox(s,{font:_e}).w||0;},calculate:function(min,max,_10,_11){if(this.initialized()){return this;}var o=this.opt;this.labels="labels" in o?o.labels:_11;this.scaler=_7.buildScaler(min,max,_10,o);var tsb=this.scaler.bounds;if("scale" in this){o.from=tsb.lower+this.offset;o.to=(tsb.upper-tsb.lower)/this.scale+o.from;if(!isFinite(o.from)||isNaN(o.from)||!isFinite(o.to)||isNaN(o.to)||o.to-o.from>=tsb.upper-tsb.lower){delete o.from;delete o.to;delete this.scale;delete this.offset;}else{if(o.from<tsb.lower){o.to+=tsb.lower-o.from;o.from=tsb.lower;}else{if(o.to>tsb.upper){o.from+=tsb.upper-o.to;o.to=tsb.upper;}}this.offset=o.from-tsb.lower;}this.scaler=_7.buildScaler(min,max,_10,o);tsb=this.scaler.bounds;if(this.scale==1&&this.offset==0){delete this.scale;delete this.offset;}}var _12=0,ta=this.chart.theme.axis,_13="font" in o?o.font:ta.font,_14=_13?g.normalizedLength(g.splitFontString(_13).size):0;if(this.vertical){if(_14){_12=_14+_8;}}else{if(_14){var _15,i;if(o.labelFunc&&o.maxLabelSize){_15=o.maxLabelSize;}else{if(this.labels){_15=this._groupLabelWidth(this.labels,_13);}else{var _16=Math.ceil(Math.log(Math.max(Math.abs(tsb.from),Math.abs(tsb.to)))/Math.LN10),t=[];if(tsb.from<0||tsb.to<0){t.push("-");}t.push(_4.string.rep("9",_16));var _17=Math.floor(Math.log(tsb.to-tsb.from)/Math.LN10);if(_17>0){t.push(".");for(i=0;i<_17;++i){t.push("9");}}_15=_6.gfx._base._getTextBox(t.join(""),{font:_13}).w;}}_12=_15+_8;}}this.scaler.minMinorStep=_12;this.ticks=_7.buildTicks(this.scaler,o);return this;},getScaler:function(){return this.scaler;},getTicks:function(){return this.ticks;},getOffsets:function(){var o=this.opt;var _18={l:0,r:0,t:0,b:0},_19,a,b,c,d,gl=dc.scaler.common.getNumericLabel,_1a=0,ta=this.chart.theme.axis,_1b="font" in o?o.font:ta.font,_1c="majorTick" in o?o.majorTick:ta.majorTick,_1d="minorTick" in o?o.minorTick:ta.minorTick,_1e=_1b?g.normalizedLength(g.splitFontString(_1b).size):0,s=this.scaler;if(!s){return _18;}var ma=s.major,mi=s.minor;if(this.vertical){if(_1e){if(o.labelFunc&&o.maxLabelSize){_19=o.maxLabelSize;}else{if(this.labels){_19=this._groupLabelWidth(this.labels,_1b);}else{_19=this._groupLabelWidth([gl(ma.start,ma.prec,o),gl(ma.start+ma.count*ma.tick,ma.prec,o),gl(mi.start,mi.prec,o),gl(mi.start+mi.count*mi.tick,mi.prec,o)],_1b);}}_1a=_19+_8;}_1a+=_8+Math.max(_1c.length,_1d.length);_18[o.leftBottom?"l":"r"]=_1a;_18.t=_18.b=_1e/2;}else{if(_1e){_1a=_1e+_8;}_1a+=_8+Math.max(_1c.length,_1d.length);_18[o.leftBottom?"b":"t"]=_1a;if(_1e){if(o.labelFunc&&o.maxLabelSize){_19=o.maxLabelSize;}else{if(this.labels){_19=this._groupLabelWidth(this.labels,_1b);}else{_19=this._groupLabelWidth([gl(ma.start,ma.prec,o),gl(ma.start+ma.count*ma.tick,ma.prec,o),gl(mi.start,mi.prec,o),gl(mi.start+mi.count*mi.tick,mi.prec,o)],_1b);}}_18.l=_18.r=_19/2;}}if(_19){this._cachedLabelWidth=_19;}return _18;},render:function(dim,_1f){if(!this.dirty){return this;}var o=this.opt;var _20,_21,_22,_23,_24,_25,ta=this.chart.theme.axis,_26="stroke" in o?o.stroke:ta.stroke,_27="majorTick" in o?o.majorTick:ta.majorTick,_28="minorTick" in o?o.minorTick:ta.minorTick,_29="microTick" in o?o.microTick:ta.minorTick,_2a="font" in o?o.font:ta.font,_2b="fontColor" in o?o.fontColor:ta.fontColor,_2c=Math.max(_27.length,_28.length),_2d=_2a?g.normalizedLength(g.splitFontString(_2a).size):0;if(this.vertical){_20={y:dim.height-_1f.b};_21={y:_1f.t};_22={x:0,y:-1};if(o.leftBottom){_20.x=_21.x=_1f.l;_23={x:-1,y:0};_25="end";}else{_20.x=_21.x=dim.width-_1f.r;_23={x:1,y:0};_25="start";}_24={x:_23.x*(_2c+_8),y:_2d*0.4};}else{_20={x:_1f.l};_21={x:dim.width-_1f.r};_22={x:1,y:0};_25="middle";if(o.leftBottom){_20.y=_21.y=dim.height-_1f.b;_23={x:0,y:1};_24={y:_2c+_8+_2d};}else{_20.y=_21.y=_1f.t;_23={x:0,y:-1};_24={y:-_2c-_8};}_24.x=0;}this.cleanGroup();try{var s=this.group,c=this.scaler,t=this.ticks,_2e,f=_7.getTransformerFromModel(this.scaler),_2f=(_6.gfx.renderer=="canvas"),_30=_2f||this.opt.htmlLabels&&!_4.isIE&&!_4.isOpera?"html":"gfx",dx=_23.x*_27.length,dy=_23.y*_27.length;s.createLine({x1:_20.x,y1:_20.y,x2:_21.x,y2:_21.y}).setStroke(_26);_4.forEach(t.major,function(_31){var _32=f(_31.value),_33,x=_20.x+_22.x*_32,y=_20.y+_22.y*_32;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_27);if(_31.label){_33=dc.axis2d.common.createText[_30](this.chart,s,x+_24.x,y+_24.y,_25,_31.label,_2a,_2b,this._cachedLabelWidth);if(_30=="html"){this.htmlElements.push(_33);}}},this);dx=_23.x*_28.length;dy=_23.y*_28.length;_2e=c.minMinorStep<=c.minor.tick*c.bounds.scale;_4.forEach(t.minor,function(_34){var _35=f(_34.value),_36,x=_20.x+_22.x*_35,y=_20.y+_22.y*_35;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_28);if(_2e&&_34.label){_36=dc.axis2d.common.createText[_30](this.chart,s,x+_24.x,y+_24.y,_25,_34.label,_2a,_2b,this._cachedLabelWidth);if(_30=="html"){this.htmlElements.push(_36);}}},this);dx=_23.x*_29.length;dy=_23.y*_29.length;_4.forEach(t.micro,function(_37){var _38=f(_37.value),_39,x=_20.x+_22.x*_38,y=_20.y+_22.y*_38;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_29);},this);}catch(e){}this.dirty=false;return this;}});})();}}};});