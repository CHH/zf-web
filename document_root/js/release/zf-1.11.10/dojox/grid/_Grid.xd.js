/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid._Grid"],["require","dijit.dijit"],["require","dijit.Menu"],["require","dojox.html.metrics"],["require","dojox.grid.util"],["require","dojox.grid._Scroller"],["require","dojox.grid._Layout"],["require","dojox.grid._View"],["require","dojox.grid._ViewManager"],["require","dojox.grid._RowManager"],["require","dojox.grid._FocusManager"],["require","dojox.grid._EditManager"],["require","dojox.grid.Selection"],["require","dojox.grid._RowSelector"],["require","dojox.grid._Events"],["requireLocalization","dijit","loading",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid._Grid"]){_4._hasResource["dojox.grid._Grid"]=true;_4.provide("dojox.grid._Grid");_4.require("dijit.dijit");_4.require("dijit.Menu");_4.require("dojox.html.metrics");_4.require("dojox.grid.util");_4.require("dojox.grid._Scroller");_4.require("dojox.grid._Layout");_4.require("dojox.grid._View");_4.require("dojox.grid._ViewManager");_4.require("dojox.grid._RowManager");_4.require("dojox.grid._FocusManager");_4.require("dojox.grid._EditManager");_4.require("dojox.grid.Selection");_4.require("dojox.grid._RowSelector");_4.require("dojox.grid._Events");(function(){if(!_4.isCopyKey){_4.isCopyKey=_4.dnd.getCopyKeyState;}_4.declare("dojox.grid._Grid",[_5._Widget,_5._Templated,_6.grid._Events],{templateString:"<div class=\"dojoxGrid\" hidefocus=\"hidefocus\" wairole=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" wairole=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" wairole=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n",classTag:"dojoxGrid",get:function(_7){},rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,sortInfo:0,themeable:true,_placeholders:null,_layoutClass:_6.grid._Layout,buildRendering:function(){this.inherited(arguments);if(this.get==_6.grid._Grid.prototype.get){this.get=null;}if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_6.html.metrics.initOnFontResize();this.connect(_6.html.metrics,"onFontResize","textSizeChanged");_6.grid.util.funnelEvents(this.domNode,this,"doKeyEvent",_6.grid.util.keyEvents);if(this.selectionMode!="none"){_4.attr(this.domNode,"aria-multiselectable",this.selectionMode=="single"?"false":"true");}},postMixInProperties:function(){this.inherited(arguments);var _8=_4.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_4.string.substitute(this.loadingMessage,_8);this.errorMessage=_4.string.substitute(this.errorMessage,_8);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){_4.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.scroller){this.scroller.destroy();delete this.scroller;}if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_4.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_9){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.attr("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_9){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _6.grid._RowManager(this);this.focus=new _6.grid._FocusManager(this);this.edit=new _6.grid._EditManager(this);},createSelection:function(){this.selection=new _6.grid.Selection(this);},createScroller:function(){this.scroller=new _6.grid._Scroller();this.scroller.grid=this;this.scroller.renderRow=_4.hitch(this,"renderRow");this.scroller.removeRow=_4.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.render();},onResizeColumn:function(_a){},createViews:function(){this.views=new _6.grid._ViewManager(this);this.views.createView=_4.hitch(this,"createView");},createView:function(_b,_c){var c=_4.getObject(_b);var _d=new c({grid:this,index:_c});this.viewsNode.appendChild(_d.domNode);this.viewsHeaderNode.appendChild(_d.headerNode);this.views.addView(_d);return _d;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_6._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_e){var s=_e;if(s&&_4.isString(s)){_4.deprecated("dojox.grid._Grid.attr('structure', 'objVar')","use dojox.grid._Grid.attr('structure', objVar) instead","2.0");s=_4.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_f){_4.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.attr('structure', obj) instead.","2.0");this._setStructureAttr(_f);},getColumnTogglingItems:function(){return _4.map(this.layout.cells,function(_10){if(!_10.menuItems){_10.menuItems=[];}var _11=this;var _12=new _5.CheckedMenuItem({label:_10.name,checked:!_10.hidden,_gridCell:_10,onChange:function(_13){if(_11.layout.setColumnVisibility(this._gridCell.index,_13)){var _14=this._gridCell.menuItems;if(_14.length>1){_4.forEach(_14,function(_15){if(_15!==this){_15.setAttribute("checked",_13);}},this);}_13=_4.filter(_11.layout.cells,function(c){if(c.menuItems.length>1){_4.forEach(c.menuItems,"item.attr('disabled', false);");}else{c.menuItems[0].attr("disabled",false);}return !c.hidden;});if(_13.length==1){_4.forEach(_13[0].menuItems,"item.attr('disabled', true);");}}},destroy:function(){var _16=_4.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_16,1);delete this._gridCell;_5.CheckedMenuItem.prototype.destroy.apply(this,arguments);}});_10.menuItems.push(_12);return _12;},this);},_setHeaderMenuAttr:function(_17){if(this._placeholders&&this._placeholders.length){_4.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=_17;if(!_17){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(_18){_4.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.attr('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(_18);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_4.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_19){this.setScrollTop(0);},getItem:function(_1a){return null;},showMessage:function(_1b){if(_1b){this.messagesNode.innerHTML=_1b;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_1c,_1d){this._pendingChangeSize=_1c;this._pendingResultSize=_1d;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||_4._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_1e,_1f){_1e=_1e||this._pendingChangeSize;_1f=_1f||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _20=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";this.viewsNode.style.height="";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_20.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_1f){_1e=_1f;}if(_1e){_4.marginBox(this.domNode,_1e);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=this._parentContentBoxHeight||_4._getContentBox(pn).h;this.domNode.style.height=Math.max(0,h)+"px";}}var _21=_4.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||_4._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_21&&hh===undefined){hh=this._getHeaderHeight();}}if(_21){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _22=(!this.initialWidth&&this.autoWidth);var w=_22?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_22){this.domNode.style.width=vw+"px";}},adaptHeight:function(_23){var t=_23===undefined?this._getHeaderHeight():_23;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _24=0,_25=0;var _26=_4.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_24++;}else{_25++;}return (!has);});if(_24>0&&_25>0){_4.forEach(_26,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.attr("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.attr("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();_4.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var _27=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=_27;}},renderRow:function(_28,_29){this.views.renderRow(_28,_29,this._skipRowRenormalize);},rowRemoved:function(_2a){this.views.rowRemoved(_2a);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_2b){_2b=Number(_2b);if(this.updating){this.invalidated[_2b]=true;}else{this.views.updateRow(_2b);this.scroller.rowHeightChanged(_2b);}},updateRows:function(_2c,_2d){_2c=Number(_2c);_2d=Number(_2d);var i;if(this.updating){for(i=0;i<_2d;i++){this.invalidated[i+_2c]=true;}}else{for(i=0;i<_2d;i++){this.views.updateRow(i+_2c,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_2c);}},updateRowCount:function(_2e){if(this.updating){this.invalidated.rowCount=_2e;}else{this.rowCount=_2e;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_2e);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_2f){this.views.updateRowStyles(_2f);},getRowNode:function(_30){if(this.focus.focusView&&!(this.focus.focusView instanceof _6.grid._RowSelector)){return this.focus.focusView.rowNodes[_30];}else{for(var i=0,_31;(_31=this.views.views[i]);i++){if(!(_31 instanceof _6.grid._RowSelector)){return _31.rowNodes[_30];}}}return null;},rowHeightChanged:function(_32){this.views.renormalizeRow(_32);this.scroller.rowHeightChanged(_32);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(_4.isIE?100:50),scrollTo:function(_33){if(!this.fastScroll){this.setScrollTop(_33);return;}var _34=Math.abs(this.lastScrollTop-_33);this.lastScrollTop=_33;if(_34>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_33;this.views.setScrollTop(_33);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _35=this;this._pendingScroll=window.setTimeout(function(){delete _35._pendingScroll;_35.finishScrollJob();},200);}else{this.setScrollTop(_33);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_36){this.scroller.scroll(this.views.setScrollTop(_36));},scrollToRow:function(_37){this.setScrollTop(this.scroller.findScrollTop(_37)+1);},styleRowNode:function(_38,_39){if(_39){this.rows.styleRowNode(_38,_39);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_3a){return this.layout.cells[_3a];},setCellWidth:function(_3b,_3c){this.getCell(_3b).unitWidth=_3c;},getCellName:function(_3d){return "Cell "+_3d.index;},canSort:function(_3e){},sort:function(){},getSortAsc:function(_3f){_3f=_3f==undefined?this.sortInfo:_3f;return Boolean(_3f>0);},getSortIndex:function(_40){_40=_40==undefined?this.sortInfo:_40;return Math.abs(_40)-1;},setSortIndex:function(_41,_42){var si=_41+1;if(_42!=undefined){si*=(_42?1:-1);}else{if(this.getSortIndex()==_41){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_43){if(this.canSort(_43)){this.sortInfo=_43;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_44,_45){this.onStartEdit(_44,_45);},doApplyCellEdit:function(_46,_47,_48){this.onApplyCellEdit(_46,_47,_48);},doCancelEdit:function(_49){this.onCancelEdit(_49);},doApplyEdit:function(_4a){this.onApplyEdit(_4a);},addRow:function(){this.updateRowCount(this.attr("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.attr("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_6.grid._Grid.markupFactory=function(_4b,_4c,_4d,_4e){var d=_4;var _4f=function(n){var w=d.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_4b.structure&&_4c.nodeName.toLowerCase()=="table"){_4b.structure=d.query("> colgroup",_4c).map(function(cg){var sv=d.attr(cg,"span");var v={noscroll:(d.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(d.hasAttr(cg,"width")){v.width=_4f(cg);}return v;});if(!_4b.structure.length){_4b.structure.push({__span:Infinity,cells:[]});}d.query("thead > tr",_4c).forEach(function(tr,_50){var _51=0;var _52=0;var _53;var _54=null;d.query("> th",tr).map(function(th){if(!_54){_53=0;_54=_4b.structure[0];}else{if(_51>=(_53+_54.__span)){_52++;_53+=_54.__span;var _55=_54;_54=_4b.structure[_52];}}var _56={name:d.trim(d.attr(th,"name")||th.innerHTML),colSpan:parseInt(d.attr(th,"colspan")||1,10),type:d.trim(d.attr(th,"cellType")||""),id:d.trim(d.attr(th,"id")||"")};_51+=_56.colSpan;var _57=d.attr(th,"rowspan");if(_57){_56.rowSpan=_57;}if(d.hasAttr(th,"width")){_56.width=_4f(th);}if(d.hasAttr(th,"relWidth")){_56.relWidth=window.parseInt(_4.attr(th,"relWidth"),10);}if(d.hasAttr(th,"hidden")){_56.hidden=d.attr(th,"hidden")=="true";}if(_4e){_4e(th,_56);}_56.type=_56.type?_4.getObject(_56.type):_6.grid.cells.Cell;if(_56.type&&_56.type.markupFactory){_56.type.markupFactory(th,_56);}if(!_54.cells[_50]){_54.cells[_50]=[];}_54.cells[_50].push(_56);});});}return new _4d(_4b,_4c);};})();}}};});