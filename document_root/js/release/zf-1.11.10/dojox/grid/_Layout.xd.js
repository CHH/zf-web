/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid._Layout"],["require","dojox.grid.cells"],["require","dojox.grid._RowSelector"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid._Layout"]){_4._hasResource["dojox.grid._Layout"]=true;_4.provide("dojox.grid._Layout");_4.require("dojox.grid.cells");_4.require("dojox.grid._RowSelector");_4.declare("dojox.grid._Layout",null,{constructor:function(_7){this.grid=_7;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_8,_9,_a,_b,_c){var _d=this.structure[_8].cells[0];var _e=this.structure[_9].cells[0];var _f=null;var _10=0;var _11=0;for(var i=0,c;c=_d[i];i++){if(c.index==_a){_10=i;break;}}_f=_d.splice(_10,1)[0];_f.view=this.grid.views.views[_9];for(i=0,c=null;c=_e[i];i++){if(c.index==_b){_11=i;break;}}if(!_c){_11+=1;}_e.splice(_11,0,_f);var _12=this.grid.getCell(this.grid.getSortIndex());if(_12){_12._currentlySorted=this.grid.getSortAsc();}this.cells=[];_a=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_a;this.cells.push(c);if("_currentlySorted" in c){var si=_a+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_a++;}}}this.grid.setupHeaderMenu();},setColumnVisibility:function(_13,_14){var _15=this.cells[_13];if(_15.hidden==_14){_15.hidden=!_14;var v=_15.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_4.marginBox(_15.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_16,_17,_18){var _19=this;var _1a=function(_1b){var w=0;if(_1b.colSpan>1){w=0;}else{w=_1b.width||_19._defaultCellProps.width||_19.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _1c={grid:this.grid,subrow:_16,layoutIndex:_17,index:this.cells.length};if(_18&&_18 instanceof _6.grid.cells._Base){var _1d=_4.clone(_18);_1c.unitWidth=_1a(_1d._props);_1d=_4.mixin(_1d,this._defaultCellProps,_18._props,_1c);return _1d;}var _1e=_18.type||this._defaultCellProps.type||_6.grid.cells.Cell;_1c.unitWidth=_1a(_18);return new _1e(_4.mixin({},this._defaultCellProps,_18,_1c));},addRowDef:function(_1f,_20){var _21=[];var _22=0,_23=0,_24=true;for(var i=0,def,_25;(def=_20[i]);i++){_25=this.addCellDef(_1f,i,def);_21.push(_25);this.cells.push(_25);if(_24&&_25.relWidth){_22+=_25.relWidth;}else{if(_25.width){var w=_25.width;if(typeof w=="string"&&w.slice(-1)=="%"){_23+=window.parseInt(w,10);}else{if(w=="auto"){_24=false;}}}}}if(_22&&_24){_4.forEach(_21,function(_26){if(_26.relWidth){_26.width=_26.unitWidth=((_26.relWidth/_22)*(100-_23))+"%";}});}return _21;},addRowsDef:function(_27){var _28=[];if(_4.isArray(_27)){if(_4.isArray(_27[0])){for(var i=0,row;_27&&(row=_27[i]);i++){_28.push(this.addRowDef(i,row));}}else{_28.push(this.addRowDef(0,_27));}}return _28;},addViewDef:function(_29){this._defaultCellProps=_29.defaultCell||{};if(_29.width&&_29.width=="auto"){delete _29.width;}return _4.mixin({},_29,{cells:this.addRowsDef(_29.rows||_29.cells)});},setStructure:function(_2a){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_6._scopeName+".grid._RowSelector"};if(_4.isString(this.grid.rowSelector)){var _2b=this.grid.rowSelector;if(_2b=="false"){sel=null;}else{if(_2b!="true"){sel["width"]=_2b;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _2c=function(def){return ("name" in def||"field" in def||"get" in def);};var _2d=function(def){if(_4.isArray(def)){if(_4.isArray(def[0])||_2c(def[0])){return true;}}return false;};var _2e=function(def){return (def!==null&&_4.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_2c(def))));};if(_4.isArray(_2a)){var _2f=false;for(var i=0,st;(st=_2a[i]);i++){if(_2e(st)){_2f=true;break;}}if(!_2f){s.push(this.addViewDef({cells:_2a}));}else{for(i=0;(st=_2a[i]);i++){if(_2d(st)){s.push(this.addViewDef({cells:st}));}else{if(_2e(st)){s.push(this.addViewDef(st));}}}}}else{if(_2e(_2a)){s.push(this.addViewDef(_2a));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});}}};});