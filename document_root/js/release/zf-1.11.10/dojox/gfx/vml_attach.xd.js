/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["require","dojox.gfx.vml"]],defineResource:function(_4,_5,_6){_4.require("dojox.gfx.vml");_4.experimental("dojox.gfx.vml_attach");(function(){_6.gfx.attachNode=function(_7){if(!_7){return null;}var s=null;switch(_7.tagName.toLowerCase()){case _6.gfx.Rect.nodeType:s=new _6.gfx.Rect(_7);_8(s);break;case _6.gfx.Ellipse.nodeType:if(_7.style.width==_7.style.height){s=new _6.gfx.Circle(_7);_9(s);}else{s=new _6.gfx.Ellipse(_7);_a(s);}break;case _6.gfx.Path.nodeType:switch(_7.getAttribute("dojoGfxType")){case "line":s=new _6.gfx.Line(_7);_b(s);break;case "polyline":s=new _6.gfx.Polyline(_7);_c(s);break;case "path":s=new _6.gfx.Path(_7);_d(s);break;case "text":s=new _6.gfx.Text(_7);_e(s);_f(s);_10(s);break;case "textpath":s=new _6.gfx.TextPath(_7);_d(s);_e(s);_f(s);break;}break;case _6.gfx.Image.nodeType:switch(_7.getAttribute("dojoGfxType")){case "image":s=new _6.gfx.Image(_7);_11(s);_12(s);break;}break;default:return null;}if(!(s instanceof _6.gfx.Image)){_13(s);_14(s);if(!(s instanceof _6.gfx.Text)){_15(s);}}return s;};_6.gfx.attachSurface=function(_16){var s=new _6.gfx.Surface();s.clipNode=_16;var r=s.rawNode=_16.firstChild;var b=r.firstChild;if(!b||b.tagName!="rect"){return null;}s.bgNode=r;return s;};var _13=function(_17){var _18=null,r=_17.rawNode,fo=r.fill;if(fo.on&&fo.type=="gradient"){var _18=_4.clone(_6.gfx.defaultLinearGradient),rad=_6.gfx.matrix._degToRad(fo.angle);_18.x2=Math.cos(rad);_18.y2=Math.sin(rad);_18.colors=[];var _19=fo.colors.value.split(";");for(var i=0;i<_19.length;++i){var t=_19[i].match(/\S+/g);if(!t||t.length!=2){continue;}_18.colors.push({offset:_6.gfx.vml._parseFloat(t[0]),color:new _4.Color(t[1])});}}else{if(fo.on&&fo.type=="gradientradial"){var _18=_4.clone(_6.gfx.defaultRadialGradient),w=parseFloat(r.style.width),h=parseFloat(r.style.height);_18.cx=isNaN(w)?0:fo.focusposition.x*w;_18.cy=isNaN(h)?0:fo.focusposition.y*h;_18.r=isNaN(w)?1:w/2;_18.colors=[];var _19=fo.colors.value.split(";");for(var i=_19.length-1;i>=0;--i){var t=_19[i].match(/\S+/g);if(!t||t.length!=2){continue;}_18.colors.push({offset:_6.gfx.vml._parseFloat(t[0]),color:new _4.Color(t[1])});}}else{if(fo.on&&fo.type=="tile"){var _18=_4.clone(_6.gfx.defaultPattern);_18.width=_6.gfx.pt2px(fo.size.x);_18.height=_6.gfx.pt2px(fo.size.y);_18.x=fo.origin.x*_18.width;_18.y=fo.origin.y*_18.height;_18.src=fo.src;}else{if(fo.on&&r.fillcolor){_18=new _4.Color(r.fillcolor+"");_18.a=fo.opacity;}}}}_17.fillStyle=_18;};var _14=function(_1a){var r=_1a.rawNode;if(!r.stroked){_1a.strokeStyle=null;return;}var _1b=_1a.strokeStyle=_4.clone(_6.gfx.defaultStroke),rs=r.stroke;_1b.color=new _4.Color(r.strokecolor.value);_1b.width=_6.gfx.normalizedLength(r.strokeweight+"");_1b.color.a=rs.opacity;_1b.cap=this._translate(this._capMapReversed,rs.endcap);_1b.join=rs.joinstyle=="miter"?rs.miterlimit:rs.joinstyle;_1b.style=rs.dashstyle;};var _15=function(_1c){var s=_1c.rawNode.skew,sm=s.matrix,so=s.offset;_1c.matrix=_6.gfx.matrix.normalize({xx:sm.xtox,xy:sm.ytox,yx:sm.xtoy,yy:sm.ytoy,dx:_6.gfx.pt2px(so.x),dy:_6.gfx.pt2px(so.y)});};var _1d=function(_1e){_1e.bgNode=_1e.rawNode.firstChild;};var _8=function(_1f){var r=_1f.rawNode,_20=r.outerHTML.match(/arcsize = \"(\d*\.?\d+[%f]?)\"/)[1],_21=r.style,_22=parseFloat(_21.width),_23=parseFloat(_21.height);_20=(_20.indexOf("%")>=0)?parseFloat(_20)/100:_6.gfx.vml._parseFloat(_20);_1f.shape=_6.gfx.makeParameters(_6.gfx.defaultRect,{x:parseInt(_21.left),y:parseInt(_21.top),width:_22,height:_23,r:Math.min(_22,_23)*_20});};var _a=function(_24){var _25=_24.rawNode.style,rx=parseInt(_25.width)/2,ry=parseInt(_25.height)/2;_24.shape=_6.gfx.makeParameters(_6.gfx.defaultEllipse,{cx:parseInt(_25.left)+rx,cy:parseInt(_25.top)+ry,rx:rx,ry:ry});};var _9=function(_26){var _27=_26.rawNode.style,r=parseInt(_27.width)/2;_26.shape=_6.gfx.makeParameters(_6.gfx.defaultCircle,{cx:parseInt(_27.left)+r,cy:parseInt(_27.top)+r,r:r});};var _b=function(_28){var _29=_28.shape=_4.clone(_6.gfx.defaultLine),p=_28.rawNode.path.v.match(_6.gfx.pathVmlRegExp);do{if(p.length<7||p[0]!="m"||p[3]!="l"||p[6]!="e"){break;}_29.x1=parseInt(p[1]);_29.y1=parseInt(p[2]);_29.x2=parseInt(p[4]);_29.y2=parseInt(p[5]);}while(false);};var _c=function(_2a){var _2b=_2a.shape=_4.clone(_6.gfx.defaultPolyline),p=_2a.rawNode.path.v.match(_6.gfx.pathVmlRegExp);do{if(p.length<3||p[0]!="m"){break;}var x=parseInt(p[0]),y=parseInt(p[1]);if(isNaN(x)||isNaN(y)){break;}_2b.points.push({x:x,y:y});if(p.length<6||p[3]!="l"){break;}for(var i=4;i<p.length;i+=2){x=parseInt(p[i]);y=parseInt(p[i+1]);if(isNaN(x)||isNaN(y)){break;}_2b.points.push({x:x,y:y});}}while(false);};var _11=function(_2c){_2c.shape=_4.clone(_6.gfx.defaultImage);_2c.shape.src=_2c.rawNode.firstChild.src;};var _12=function(_2d){var m=_2d.rawNode.filters["DXImageTransform.Microsoft.Matrix"];_2d.matrix=_6.gfx.matrix.normalize({xx:m.M11,xy:m.M12,yx:m.M21,yy:m.M22,dx:m.Dx,dy:m.Dy});};var _e=function(_2e){var _2f=_2e.shape=_4.clone(_6.gfx.defaultText),r=_2e.rawNode,p=r.path.v.match(_6.gfx.pathVmlRegExp);do{if(!p||p.length!=7){break;}var c=r.childNodes,i=0;for(;i<c.length&&c[i].tagName!="textpath";++i){}if(i>=c.length){break;}var s=c[i].style;_2f.text=c[i].string;switch(s["v-text-align"]){case "left":_2f.x=parseInt(p[1]);_2f.align="start";break;case "center":_2f.x=(parseInt(p[1])+parseInt(p[4]))/2;_2f.align="middle";break;case "right":_2f.x=parseInt(p[4]);_2f.align="end";break;}_2f.y=parseInt(p[2]);_2f.decoration=s["text-decoration"];_2f.rotated=s["v-rotate-letters"].toLowerCase() in _6.gfx.vml._bool;_2f.kerning=s["v-text-kern"].toLowerCase() in _6.gfx.vml._bool;return;}while(false);_2e.shape=null;};var _f=function(_30){var _31=_30.fontStyle=_4.clone(_6.gfx.defaultFont),c=_30.rawNode.childNodes,i=0;for(;i<c.length&&c[i].tagName=="textpath";++i){}if(i>=c.length){_30.fontStyle=null;return;}var s=c[i].style;_31.style=s.fontstyle;_31.variant=s.fontvariant;_31.weight=s.fontweight;_31.size=s.fontsize;_31.family=s.fontfamily;};var _10=function(_32){_15(_32);var _33=_32.matrix,fs=_32.fontStyle;if(_33&&fs){_32.matrix=_6.gfx.matrix.multiply(_33,{dy:_6.gfx.normalizedLength(fs.size)*0.35});}};var _d=function(_34){var _35=_34.shape=_4.clone(_6.gfx.defaultPath),p=_34.rawNode.path.v.match(_6.gfx.pathVmlRegExp),t=[],_36=false,map=_6.gfx.Path._pathVmlToSvgMap;for(var i=0;i<p.length;++p){var s=p[i];if(s in map){_36=false;t.push(map[s]);}else{if(!_36){var n=parseInt(s);if(isNaN(n)){_36=true;}else{t.push(n);}}}}var l=t.length;if(l>=4&&t[l-1]==""&&t[l-2]==0&&t[l-3]==0&&t[l-4]=="l"){t.splice(l-4,4);}if(l){_35.path=t.join(" ");}};})();}};});