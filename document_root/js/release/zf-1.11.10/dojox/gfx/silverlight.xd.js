/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.silverlight"],["require","dojox.gfx._base"],["require","dojox.gfx.shape"],["require","dojox.gfx.path"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.silverlight"]){_4._hasResource["dojox.gfx.silverlight"]=true;_4.provide("dojox.gfx.silverlight");_4.require("dojox.gfx._base");_4.require("dojox.gfx.shape");_4.require("dojox.gfx.path");_4.experimental("dojox.gfx.silverlight");_6.gfx.silverlight.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};_6.gfx.silverlight.fontweight={normal:400,bold:700};_6.gfx.silverlight.caps={butt:"Flat",round:"Round",square:"Square"};_6.gfx.silverlight.joins={bevel:"Bevel",round:"Round"};_6.gfx.silverlight.fonts={serif:"Times New Roman",times:"Times New Roman","sans-serif":"Arial",helvetica:"Arial",monotone:"Courier New",courier:"Courier New"};_6.gfx.silverlight.hexColor=function(_7){var c=_6.gfx.normalizeColor(_7),t=c.toHex(),a=Math.round(c.a*255);a=(a<0?0:a>255?255:a).toString(16);return "#"+(a.length<2?"0"+a:a)+t.slice(1);};_4.extend(_6.gfx.Shape,{setFill:function(_8){var p=this.rawNode.getHost().content,r=this.rawNode,f;if(!_8){this.fillStyle=null;this._setFillAttr(null);return this;}if(typeof (_8)=="object"&&"type" in _8){switch(_8.type){case "linear":this.fillStyle=f=_6.gfx.makeParameters(_6.gfx.defaultLinearGradient,_8);var _9=p.createFromXaml("<LinearGradientBrush/>");_9.mappingMode="Absolute";_9.startPoint=f.x1+","+f.y1;_9.endPoint=f.x2+","+f.y2;_4.forEach(f.colors,function(c){var t=p.createFromXaml("<GradientStop/>");t.offset=c.offset;t.color=_6.gfx.silverlight.hexColor(c.color);_9.gradientStops.add(t);});this._setFillAttr(_9);break;case "radial":this.fillStyle=f=_6.gfx.makeParameters(_6.gfx.defaultRadialGradient,_8);var _a=p.createFromXaml("<RadialGradientBrush/>"),c=_6.gfx.matrix.multiplyPoint(_6.gfx.matrix.invert(this._getAdjustedMatrix()),f.cx,f.cy),pt=c.x+","+c.y;_a.mappingMode="Absolute";_a.gradientOrigin=pt;_a.center=pt;_a.radiusX=_a.radiusY=f.r;_4.forEach(f.colors,function(c){var t=p.createFromXaml("<GradientStop/>");t.offset=c.offset;t.color=_6.gfx.silverlight.hexColor(c.color);_a.gradientStops.add(t);});this._setFillAttr(_a);break;case "pattern":this.fillStyle=null;this._setFillAttr(null);break;}return this;}this.fillStyle=f=_6.gfx.normalizeColor(_8);var _b=p.createFromXaml("<SolidColorBrush/>");_b.color=f.toHex();_b.opacity=f.a;this._setFillAttr(_b);return this;},_setFillAttr:function(f){this.rawNode.fill=f;},setStroke:function(_c){var p=this.rawNode.getHost().content,r=this.rawNode;if(!_c){this.strokeStyle=null;r.stroke=null;return this;}if(typeof _c=="string"||_4.isArray(_c)||_c instanceof _4.Color){_c={color:_c};}var s=this.strokeStyle=_6.gfx.makeParameters(_6.gfx.defaultStroke,_c);s.color=_6.gfx.normalizeColor(s.color);if(s){var _d=p.createFromXaml("<SolidColorBrush/>");_d.color=s.color.toHex();_d.opacity=s.color.a;r.stroke=_d;r.strokeThickness=s.width;r.strokeStartLineCap=r.strokeEndLineCap=r.strokeDashCap=_6.gfx.silverlight.caps[s.cap];if(typeof s.join=="number"){r.strokeLineJoin="Miter";r.strokeMiterLimit=s.join;}else{r.strokeLineJoin=_6.gfx.silverlight.joins[s.join];}var da=s.style.toLowerCase();if(da in _6.gfx.silverlight.dasharray){da=_6.gfx.silverlight.dasharray[da];}if(da instanceof Array){da=_4.clone(da);var i;if(s.cap!="butt"){for(i=0;i<da.length;i+=2){--da[i];if(da[i]<1){da[i]=1;}}for(i=1;i<da.length;i+=2){++da[i];}}r.strokeDashArray=da.join(",");}else{r.strokeDashArray=null;}}return this;},_getParentSurface:function(){var _e=this.parent;for(;_e&&!(_e instanceof _6.gfx.Surface);_e=_e.parent){}return _e;},_applyTransform:function(){var tm=this._getAdjustedMatrix(),r=this.rawNode;if(tm){var p=this.rawNode.getHost().content,m=p.createFromXaml("<MatrixTransform/>"),mm=p.createFromXaml("<Matrix/>");mm.m11=tm.xx;mm.m21=tm.xy;mm.m12=tm.yx;mm.m22=tm.yy;mm.offsetX=tm.dx;mm.offsetY=tm.dy;m.matrix=mm;r.renderTransform=m;}else{r.renderTransform=null;}return this;},setRawNode:function(_f){_f.fill=null;_f.stroke=null;this.rawNode=_f;},_moveToFront:function(){var c=this.parent.rawNode.children,r=this.rawNode;c.remove(r);c.add(r);return this;},_moveToBack:function(){var c=this.parent.rawNode.children,r=this.rawNode;c.remove(r);c.insert(0,r);return this;},_getAdjustedMatrix:function(){return this.matrix;}});_4.declare("dojox.gfx.Group",_6.gfx.Shape,{constructor:function(){_6.gfx.silverlight.Container._init.call(this);},setRawNode:function(_10){this.rawNode=_10;}});_6.gfx.Group.nodeType="Canvas";_4.declare("dojox.gfx.Rect",_6.gfx.shape.Rect,{setShape:function(_11){this.shape=_6.gfx.makeParameters(this.shape,_11);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=n.width;r.height=n.height;r.radiusX=r.radiusY=n.r;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.x,dy:s.y};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Rect.nodeType="Rectangle";_4.declare("dojox.gfx.Ellipse",_6.gfx.shape.Ellipse,{setShape:function(_12){this.shape=_6.gfx.makeParameters(this.shape,_12);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=2*n.rx;r.height=2*n.ry;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.cx-s.rx,dy:s.cy-s.ry};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Ellipse.nodeType="Ellipse";_4.declare("dojox.gfx.Circle",_6.gfx.shape.Circle,{setShape:function(_13){this.shape=_6.gfx.makeParameters(this.shape,_13);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=r.height=2*n.r;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.cx-s.r,dy:s.cy-s.r};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Circle.nodeType="Ellipse";_4.declare("dojox.gfx.Line",_6.gfx.shape.Line,{setShape:function(_14){this.shape=_6.gfx.makeParameters(this.shape,_14);this.bbox=null;var r=this.rawNode,n=this.shape;r.x1=n.x1;r.y1=n.y1;r.x2=n.x2;r.y2=n.y2;return this;}});_6.gfx.Line.nodeType="Line";_4.declare("dojox.gfx.Polyline",_6.gfx.shape.Polyline,{setShape:function(_15,_16){if(_15&&_15 instanceof Array){this.shape=_6.gfx.makeParameters(this.shape,{points:_15});if(_16&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=_6.gfx.makeParameters(this.shape,_15);}this.bbox=null;this._normalizePoints();var p=this.shape.points,rp=[];for(var i=0;i<p.length;++i){rp.push(p[i].x,p[i].y);}this.rawNode.points=rp.join(",");return this;}});_6.gfx.Polyline.nodeType="Polyline";_4.declare("dojox.gfx.Image",_6.gfx.shape.Image,{setShape:function(_17){this.shape=_6.gfx.makeParameters(this.shape,_17);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=n.width;r.height=n.height;r.source=n.src;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.x,dy:s.y};return new _6.gfx.Matrix2D(m?[m,d]:d);},setRawNode:function(_18){this.rawNode=_18;}});_6.gfx.Image.nodeType="Image";_4.declare("dojox.gfx.Text",_6.gfx.shape.Text,{setShape:function(_19){this.shape=_6.gfx.makeParameters(this.shape,_19);this.bbox=null;var r=this.rawNode,s=this.shape;r.text=s.text;r.textDecorations=s.decoration==="underline"?"Underline":"None";r["Canvas.Left"]=-10000;r["Canvas.Top"]=-10000;if(!this._delay){this._delay=window.setTimeout(_4.hitch(this,"_delayAlignment"),10);}return this;},_delayAlignment:function(){var r=this.rawNode,s=this.shape,w=r.actualWidth,h=r.actualHeight,x=s.x,y=s.y-h*0.75;switch(s.align){case "middle":x-=w/2;break;case "end":x-=w;break;}this._delta={dx:x,dy:y};r["Canvas.Left"]=0;r["Canvas.Top"]=0;this._applyTransform();delete this._delay;},_getAdjustedMatrix:function(){var m=this.matrix,d=this._delta,x;if(m){x=d?[m,d]:m;}else{x=d?d:{};}return new _6.gfx.Matrix2D(x);},setStroke:function(){return this;},_setFillAttr:function(f){this.rawNode.foreground=f;},setRawNode:function(_1a){this.rawNode=_1a;},getTextWidth:function(){return this.rawNode.actualWidth;}});_6.gfx.Text.nodeType="TextBlock";_4.declare("dojox.gfx.Path",_6.gfx.path.Path,{_updateWithSegment:function(_1b){_6.gfx.Path.superclass._updateWithSegment.apply(this,arguments);var p=this.shape.path;if(typeof (p)=="string"){this.rawNode.data=p?p:null;}},setShape:function(_1c){_6.gfx.Path.superclass.setShape.apply(this,arguments);var p=this.shape.path;this.rawNode.data=p?p:null;return this;}});_6.gfx.Path.nodeType="Path";_4.declare("dojox.gfx.TextPath",_6.gfx.path.TextPath,{_updateWithSegment:function(_1d){},setShape:function(_1e){},_setText:function(){}});_6.gfx.TextPath.nodeType="text";_6.gfx.silverlight.surfaces={};_6.gfx.silverlight.nullFunc=function(){};_4.declare("dojox.gfx.Surface",_6.gfx.shape.Surface,{constructor:function(){_6.gfx.silverlight.Container._init.call(this);},destroy:function(){window[this._onLoadName]=_6.gfx.silverlight.nullFunc;delete _6.gfx.silverlight.surfaces[this.rawNode.name];this.inherited(arguments);},setDimensions:function(_1f,_20){this.width=_6.gfx.normalizedLength(_1f);this.height=_6.gfx.normalizedLength(_20);var p=this.rawNode&&this.rawNode.getHost();if(p){p.width=_1f;p.height=_20;}return this;},getDimensions:function(){var p=this.rawNode&&this.rawNode.getHost();var t=p?{width:p.content.actualWidth,height:p.content.actualHeight}:null;if(t.width<=0){t.width=this.width;}if(t.height<=0){t.height=this.height;}return t;}});_6.gfx.createSurface=function(_21,_22,_23){if(!_22&&!_23){var pos=d.position(_21);_22=_22||pos.w;_23=_23||pos.h;}if(typeof _22=="number"){_22=_22+"px";}if(typeof _23=="number"){_23=_23+"px";}var s=new _6.gfx.Surface();_21=_4.byId(_21);s._parent=_21;var t=_21.ownerDocument.createElement("script");t.type="text/xaml";t.id=_6.gfx._base._getUniqueId();t.text="<?xml version='1.0'?><Canvas xmlns='http://schemas.microsoft.com/client/2007' Name='"+_6.gfx._base._getUniqueId()+"'/>";_21.parentNode.insertBefore(t,_21);s._nodes.push(t);var obj,_24=_6.gfx._base._getUniqueId(),_25="__"+_6.gfx._base._getUniqueId()+"_onLoad";s._onLoadName=_25;window[_25]=function(_26){console.log("Silverlight: loaded");if(!s.rawNode){s.rawNode=_4.byId(_24).content.root;_6.gfx.silverlight.surfaces[s.rawNode.name]=_21;s.onLoad(s);console.log("Silverlight: assigned");}};if(_4.isSafari){obj="<embed type='application/x-silverlight' id='"+_24+"' width='"+_22+"' height='"+_23+" background='transparent'"+" source='#"+t.id+"'"+" windowless='true'"+" maxFramerate='60'"+" onLoad='"+_25+"'"+" onError='__dojoSilverlightError'"+" /><iframe style='visibility:hidden;height:0;width:0'/>";}else{obj="<object type='application/x-silverlight' data='data:application/x-silverlight,' id='"+_24+"' width='"+_22+"' height='"+_23+"'>"+"<param name='background' value='transparent' />"+"<param name='source' value='#"+t.id+"' />"+"<param name='windowless' value='true' />"+"<param name='maxFramerate' value='60' />"+"<param name='onLoad' value='"+_25+"' />"+"<param name='onError' value='__dojoSilverlightError' />"+"</object>";}_21.innerHTML=obj;var _27=_4.byId(_24);if(_27.content&&_27.content.root){s.rawNode=_27.content.root;_6.gfx.silverlight.surfaces[s.rawNode.name]=_21;}else{s.rawNode=null;s.isLoaded=false;}s._nodes.push(_27);s.width=_6.gfx.normalizedLength(_22);s.height=_6.gfx.normalizedLength(_23);return s;};__dojoSilverlightError=function(_28,err){var t="Silverlight Error:\n"+"Code: "+err.ErrorCode+"\n"+"Type: "+err.ErrorType+"\n"+"Message: "+err.ErrorMessage+"\n";switch(err.ErrorType){case "ParserError":t+="XamlFile: "+err.xamlFile+"\n"+"Line: "+err.lineNumber+"\n"+"Position: "+err.charPosition+"\n";break;case "RuntimeError":t+="MethodName: "+err.methodName+"\n";if(err.lineNumber!=0){t+="Line: "+err.lineNumber+"\n"+"Position: "+err.charPosition+"\n";}break;}console.error(t);};_6.gfx.silverlight.Font={_setFont:function(){var f=this.fontStyle,r=this.rawNode,fw=_6.gfx.silverlight.fontweight,fo=_6.gfx.silverlight.fonts,t=f.family.toLowerCase();r.fontStyle=f.style=="italic"?"Italic":"Normal";r.fontWeight=f.weight in fw?fw[f.weight]:f.weight;r.fontSize=_6.gfx.normalizedLength(f.size);r.fontFamily=t in fo?fo[t]:f.family;if(!this._delay){this._delay=window.setTimeout(_4.hitch(this,"_delayAlignment"),10);}}};_6.gfx.silverlight.Container={_init:function(){_6.gfx.shape.Container._init.call(this);},add:function(_29){if(this!=_29.getParent()){_6.gfx.shape.Container.add.apply(this,arguments);this.rawNode.children.add(_29.rawNode);}return this;},remove:function(_2a,_2b){if(this==_2a.getParent()){var _2c=_2a.rawNode.getParent();if(_2c){_2c.children.remove(_2a.rawNode);}_6.gfx.shape.Container.remove.apply(this,arguments);}return this;},clear:function(){this.rawNode.children.clear();return _6.gfx.shape.Container.clear.apply(this,arguments);},_moveChildToFront:_6.gfx.shape.Container._moveChildToFront,_moveChildToBack:_6.gfx.shape.Container._moveChildToBack};_4.mixin(_6.gfx.shape.Creator,{createObject:function(_2d,_2e){if(!this.rawNode){return null;}var _2f=new _2d();var _30=this.rawNode.getHost().content.createFromXaml("<"+_2d.nodeType+"/>");_2f.setRawNode(_30);_2f.setShape(_2e);this.add(_2f);return _2f;}});_4.extend(_6.gfx.Text,_6.gfx.silverlight.Font);_4.extend(_6.gfx.Group,_6.gfx.silverlight.Container);_4.extend(_6.gfx.Group,_6.gfx.shape.Creator);_4.extend(_6.gfx.Surface,_6.gfx.silverlight.Container);_4.extend(_6.gfx.Surface,_6.gfx.shape.Creator);(function(){var _31=_6.gfx.silverlight.surfaces;var _32=function(s,a){var ev={target:s,currentTarget:s,preventDefault:function(){},stopPropagation:function(){}};if(a){try{ev.ctrlKey=a.ctrl;ev.shiftKey=a.shift;var p=a.getPosition(null);ev.x=ev.offsetX=ev.layerX=p.x;ev.y=ev.offsetY=ev.layerY=p.y;var _33=_31[s.getHost().content.root.name];var t=_4.position(_33);ev.clientX=t.x+p.x;ev.clientY=t.y+p.y;}catch(e){}}return ev;};var _34=function(s,a){var ev={keyCode:a.platformKeyCode,ctrlKey:a.ctrl,shiftKey:a.shift};return ev;};var _35={onclick:{name:"MouseLeftButtonUp",fix:_32},onmouseenter:{name:"MouseEnter",fix:_32},onmouseleave:{name:"MouseLeave",fix:_32},onmouseover:{name:"MouseEnter",fix:_32},onmouseout:{name:"MouseLeave",fix:_32},onmousedown:{name:"MouseLeftButtonDown",fix:_32},onmouseup:{name:"MouseLeftButtonUp",fix:_32},onmousemove:{name:"MouseMove",fix:_32},onkeydown:{name:"KeyDown",fix:_34},onkeyup:{name:"KeyUp",fix:_34}};var _36={connect:function(_37,_38,_39){var _3a,n=_37 in _35?_35[_37]:{name:_37,fix:function(){return {};}};if(arguments.length>2){_3a=this.getEventSource().addEventListener(n.name,function(s,a){_4.hitch(_38,_39)(n.fix(s,a));});}else{_3a=this.getEventSource().addEventListener(n.name,function(s,a){_38(n.fix(s,a));});}return {name:n.name,token:_3a};},disconnect:function(_3b){this.getEventSource().removeEventListener(_3b.name,_3b.token);}};_4.extend(_6.gfx.Shape,_36);_4.extend(_6.gfx.Surface,_36);_6.gfx.equalSources=function(a,b){return a&&b&&a.equals(b);};})();}}};});